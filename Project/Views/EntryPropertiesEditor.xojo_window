#tag Window
Begin ContainerControl EntryPropertiesEditor
   AcceptFocus     =   False
   AcceptTabs      =   True
   AutoDeactivate  =   True
   BackColor       =   &cFFFFFF00
   Backdrop        =   0
   Compatibility   =   ""
   Enabled         =   True
   EraseBackground =   True
   HasBackColor    =   False
   Height          =   209
   HelpTag         =   ""
   InitialParent   =   ""
   Left            =   0
   LockBottom      =   True
   LockLeft        =   True
   LockRight       =   True
   LockTop         =   True
   TabIndex        =   0
   TabPanelIndex   =   0
   TabStop         =   True
   Top             =   0
   Transparent     =   True
   UseFocusRing    =   False
   Visible         =   True
   Width           =   498
   Begin CheckBox EditChanceCheck
      AutoDeactivate  =   True
      Bold            =   False
      Caption         =   "Edit"
      DataField       =   ""
      DataSource      =   ""
      Enabled         =   True
      Height          =   23
      HelpTag         =   ""
      Index           =   -2147483648
      InitialParent   =   ""
      Italic          =   False
      Left            =   430
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   False
      LockRight       =   True
      LockTop         =   True
      Scope           =   2
      State           =   1
      TabIndex        =   16
      TabPanelIndex   =   0
      TabStop         =   True
      TextFont        =   "System"
      TextSize        =   0.0
      TextUnit        =   0
      Top             =   142
      Underline       =   False
      Value           =   True
      Visible         =   False
      Width           =   58
   End
   Begin CheckBox EditMaxQualityCheck
      AutoDeactivate  =   True
      Bold            =   False
      Caption         =   "Edit"
      DataField       =   ""
      DataSource      =   ""
      Enabled         =   True
      Height          =   20
      HelpTag         =   ""
      Index           =   -2147483648
      InitialParent   =   ""
      Italic          =   False
      Left            =   430
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   False
      LockRight       =   True
      LockTop         =   True
      Scope           =   2
      State           =   1
      TabIndex        =   11
      TabPanelIndex   =   0
      TabStop         =   True
      TextFont        =   "System"
      TextSize        =   0.0
      TextUnit        =   0
      Top             =   110
      Underline       =   False
      Value           =   True
      Visible         =   False
      Width           =   58
   End
   Begin CheckBox EditMinQualityCheck
      AutoDeactivate  =   True
      Bold            =   False
      Caption         =   "Edit"
      DataField       =   ""
      DataSource      =   ""
      Enabled         =   True
      Height          =   20
      HelpTag         =   ""
      Index           =   -2147483648
      InitialParent   =   ""
      Italic          =   False
      Left            =   430
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   False
      LockRight       =   True
      LockTop         =   True
      Scope           =   2
      State           =   1
      TabIndex        =   8
      TabPanelIndex   =   0
      TabStop         =   True
      TextFont        =   "System"
      TextSize        =   0.0
      TextUnit        =   0
      Top             =   78
      Underline       =   False
      Value           =   True
      Visible         =   False
      Width           =   58
   End
   Begin CheckBox EditMaxQuantityCheck
      AutoDeactivate  =   True
      Bold            =   False
      Caption         =   "Edit"
      DataField       =   ""
      DataSource      =   ""
      Enabled         =   True
      Height          =   22
      HelpTag         =   ""
      Index           =   -2147483648
      InitialParent   =   ""
      Italic          =   False
      Left            =   430
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   False
      LockRight       =   True
      LockTop         =   True
      Scope           =   2
      State           =   1
      TabIndex        =   5
      TabPanelIndex   =   0
      TabStop         =   True
      TextFont        =   "System"
      TextSize        =   0.0
      TextUnit        =   0
      Top             =   44
      Underline       =   False
      Value           =   True
      Visible         =   False
      Width           =   58
   End
   Begin CheckBox EditMinQuantityCheck
      AutoDeactivate  =   True
      Bold            =   False
      Caption         =   "Edit"
      DataField       =   ""
      DataSource      =   ""
      Enabled         =   True
      Height          =   22
      HelpTag         =   ""
      Index           =   -2147483648
      InitialParent   =   ""
      Italic          =   False
      Left            =   430
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   False
      LockRight       =   True
      LockTop         =   True
      Scope           =   2
      State           =   1
      TabIndex        =   2
      TabPanelIndex   =   0
      TabStop         =   True
      TextFont        =   "System"
      TextSize        =   0.0
      TextUnit        =   0
      Top             =   10
      Underline       =   False
      Value           =   True
      Visible         =   False
      Width           =   58
   End
   Begin UITweaks.ResizedLabel ChancePercentLabel
      AutoDeactivate  =   True
      Bold            =   False
      DataField       =   ""
      DataSource      =   ""
      Enabled         =   True
      Height          =   22
      HelpTag         =   ""
      Index           =   -2147483648
      InitialParent   =   ""
      Italic          =   False
      Left            =   381
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   False
      LockRight       =   True
      LockTop         =   True
      Multiline       =   False
      Scope           =   2
      Selectable      =   False
      TabIndex        =   15
      TabPanelIndex   =   0
      Text            =   "%"
      TextAlign       =   0
      TextColor       =   &c00000000
      TextFont        =   "System"
      TextSize        =   0.0
      TextUnit        =   0
      Top             =   142
      Transparent     =   True
      Underline       =   False
      Visible         =   True
      Width           =   37
   End
   Begin UITweaks.ResizedTextField ChanceField
      AcceptTabs      =   False
      Alignment       =   3
      AutoDeactivate  =   False
      AutomaticallyCheckSpelling=   False
      BackColor       =   &cFFFFFF00
      Bold            =   False
      Border          =   True
      CueText         =   ""
      DataField       =   ""
      DataSource      =   ""
      Enabled         =   True
      Format          =   ""
      Height          =   22
      HelpTag         =   ""
      Index           =   -2147483648
      InitialParent   =   ""
      Italic          =   False
      Left            =   325
      LimitText       =   3
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   False
      LockRight       =   True
      LockTop         =   True
      Mask            =   "99#"
      Password        =   False
      ReadOnly        =   False
      Scope           =   2
      TabIndex        =   14
      TabPanelIndex   =   0
      TabStop         =   True
      Text            =   "25"
      TextColor       =   &c00000000
      TextFont        =   "System"
      TextSize        =   0.0
      TextUnit        =   0
      Top             =   142
      Underline       =   False
      UseFocusRing    =   True
      Visible         =   True
      Width           =   53
   End
   Begin Slider ChanceSlider
      AutoDeactivate  =   True
      Enabled         =   True
      Height          =   23
      HelpTag         =   "Items with a higher weight will be selected more frequently than items with a smaller weight. Two items with the same weight will be selected at the same frequency."
      Index           =   -2147483648
      InitialParent   =   ""
      Left            =   174
      LineStep        =   5
      LiveScroll      =   True
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   True
      LockTop         =   True
      Maximum         =   100
      Minimum         =   0
      PageStep        =   25
      Scope           =   2
      TabIndex        =   13
      TabPanelIndex   =   0
      TabStop         =   True
      TickStyle       =   "0"
      Top             =   142
      Value           =   25
      Visible         =   True
      Width           =   139
   End
   Begin Label ChanceLabel
      AutoDeactivate  =   True
      Bold            =   False
      DataField       =   ""
      DataSource      =   ""
      Enabled         =   True
      Height          =   23
      HelpTag         =   ""
      Index           =   -2147483648
      InitialParent   =   ""
      Italic          =   False
      Left            =   10
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      Multiline       =   False
      Scope           =   2
      Selectable      =   False
      TabIndex        =   12
      TabPanelIndex   =   0
      Text            =   "Chance To Be Blueprint:"
      TextAlign       =   2
      TextColor       =   &c00000000
      TextFont        =   "System"
      TextSize        =   0.0
      TextUnit        =   0
      Top             =   142
      Transparent     =   True
      Underline       =   False
      Visible         =   True
      Width           =   152
   End
   Begin UITweaks.ResizedPopupMenu QualityMenus
      AutoDeactivate  =   True
      Bold            =   False
      DataField       =   ""
      DataSource      =   ""
      Enabled         =   True
      Height          =   20
      HelpTag         =   ""
      Index           =   1
      InitialParent   =   ""
      InitialValue    =   ""
      Italic          =   False
      Left            =   174
      ListIndex       =   0
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   True
      LockTop         =   True
      Scope           =   2
      TabIndex        =   10
      TabPanelIndex   =   0
      TabStop         =   True
      TextFont        =   "System"
      TextSize        =   0.0
      TextUnit        =   0
      Top             =   110
      Underline       =   False
      Visible         =   True
      Width           =   244
   End
   Begin Label MaxQualityLabel
      AutoDeactivate  =   True
      Bold            =   False
      DataField       =   ""
      DataSource      =   ""
      Enabled         =   True
      Height          =   20
      HelpTag         =   ""
      Index           =   -2147483648
      InitialParent   =   ""
      Italic          =   False
      Left            =   10
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      Multiline       =   False
      Scope           =   2
      Selectable      =   False
      TabIndex        =   9
      TabPanelIndex   =   0
      Text            =   "Max Quality:"
      TextAlign       =   2
      TextColor       =   &c00000000
      TextFont        =   "System"
      TextSize        =   0.0
      TextUnit        =   0
      Top             =   110
      Transparent     =   True
      Underline       =   False
      Visible         =   True
      Width           =   152
   End
   Begin UITweaks.ResizedPopupMenu QualityMenus
      AutoDeactivate  =   True
      Bold            =   False
      DataField       =   ""
      DataSource      =   ""
      Enabled         =   True
      Height          =   20
      HelpTag         =   ""
      Index           =   0
      InitialParent   =   ""
      InitialValue    =   ""
      Italic          =   False
      Left            =   174
      ListIndex       =   0
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   True
      LockTop         =   True
      Scope           =   2
      TabIndex        =   7
      TabPanelIndex   =   0
      TabStop         =   True
      TextFont        =   "System"
      TextSize        =   0.0
      TextUnit        =   0
      Top             =   78
      Underline       =   False
      Visible         =   True
      Width           =   244
   End
   Begin Label MinQualityLabel
      AutoDeactivate  =   True
      Bold            =   False
      DataField       =   ""
      DataSource      =   ""
      Enabled         =   True
      Height          =   20
      HelpTag         =   ""
      Index           =   -2147483648
      InitialParent   =   ""
      Italic          =   False
      Left            =   10
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      Multiline       =   False
      Scope           =   2
      Selectable      =   False
      TabIndex        =   6
      TabPanelIndex   =   0
      Text            =   "Min Quality:"
      TextAlign       =   2
      TextColor       =   &c00000000
      TextFont        =   "System"
      TextSize        =   0.0
      TextUnit        =   0
      Top             =   78
      Transparent     =   True
      Underline       =   False
      Visible         =   True
      Width           =   152
   End
   Begin UITweaks.ResizedTextField MaxQuantityField
      AcceptTabs      =   False
      Alignment       =   0
      AutoDeactivate  =   True
      AutomaticallyCheckSpelling=   False
      BackColor       =   &cFFFFFF00
      Bold            =   False
      Border          =   True
      CueText         =   ""
      DataField       =   ""
      DataSource      =   ""
      Enabled         =   True
      Format          =   ""
      Height          =   22
      HelpTag         =   ""
      Index           =   -2147483648
      InitialParent   =   ""
      Italic          =   False
      Left            =   174
      LimitText       =   0
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      Mask            =   "###"
      Password        =   False
      ReadOnly        =   False
      Scope           =   2
      TabIndex        =   4
      TabPanelIndex   =   0
      TabStop         =   True
      Text            =   "1"
      TextColor       =   &c00000000
      TextFont        =   "System"
      TextSize        =   0.0
      TextUnit        =   0
      Top             =   44
      Underline       =   False
      UseFocusRing    =   True
      Visible         =   True
      Width           =   80
   End
   Begin Label MaxQuantityLabel
      AutoDeactivate  =   True
      Bold            =   False
      DataField       =   ""
      DataSource      =   ""
      Enabled         =   True
      Height          =   22
      HelpTag         =   ""
      Index           =   -2147483648
      InitialParent   =   ""
      Italic          =   False
      Left            =   10
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      Multiline       =   False
      Scope           =   2
      Selectable      =   False
      TabIndex        =   3
      TabPanelIndex   =   0
      Text            =   "Max Quantity:"
      TextAlign       =   2
      TextColor       =   &c00000000
      TextFont        =   "System"
      TextSize        =   0.0
      TextUnit        =   0
      Top             =   44
      Transparent     =   True
      Underline       =   False
      Visible         =   True
      Width           =   152
   End
   Begin UITweaks.ResizedTextField MinQuantityField
      AcceptTabs      =   False
      Alignment       =   0
      AutoDeactivate  =   True
      AutomaticallyCheckSpelling=   False
      BackColor       =   &cFFFFFF00
      Bold            =   False
      Border          =   True
      CueText         =   ""
      DataField       =   ""
      DataSource      =   ""
      Enabled         =   True
      Format          =   ""
      Height          =   22
      HelpTag         =   ""
      Index           =   -2147483648
      InitialParent   =   ""
      Italic          =   False
      Left            =   174
      LimitText       =   0
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      Mask            =   "###"
      Password        =   False
      ReadOnly        =   False
      Scope           =   2
      TabIndex        =   1
      TabPanelIndex   =   0
      TabStop         =   True
      Text            =   "1"
      TextColor       =   &c00000000
      TextFont        =   "System"
      TextSize        =   0.0
      TextUnit        =   0
      Top             =   10
      Underline       =   False
      UseFocusRing    =   True
      Visible         =   True
      Width           =   80
   End
   Begin Label MinQuantityLabel
      AutoDeactivate  =   True
      Bold            =   False
      DataField       =   ""
      DataSource      =   ""
      Enabled         =   True
      Height          =   22
      HelpTag         =   ""
      Index           =   -2147483648
      InitialParent   =   ""
      Italic          =   False
      Left            =   10
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      Multiline       =   False
      Scope           =   2
      Selectable      =   False
      TabIndex        =   0
      TabPanelIndex   =   0
      Text            =   "Min Quantity:"
      TextAlign       =   2
      TextColor       =   &c00000000
      TextFont        =   "System"
      TextSize        =   0.0
      TextUnit        =   0
      Top             =   10
      Transparent     =   True
      Underline       =   False
      Visible         =   True
      Width           =   152
   End
   Begin Label WeightLabel
      AutoDeactivate  =   True
      Bold            =   False
      DataField       =   ""
      DataSource      =   ""
      Enabled         =   True
      Height          =   23
      HelpTag         =   ""
      Index           =   -2147483648
      InitialParent   =   ""
      Italic          =   False
      Left            =   10
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      Multiline       =   False
      Scope           =   2
      Selectable      =   False
      TabIndex        =   17
      TabPanelIndex   =   0
      Text            =   "Weight:"
      TextAlign       =   2
      TextColor       =   &c00000000
      TextFont        =   "System"
      TextSize        =   0.0
      TextUnit        =   0
      Top             =   176
      Transparent     =   True
      Underline       =   False
      Visible         =   True
      Width           =   152
   End
   Begin Slider WeightSlider
      AutoDeactivate  =   True
      Enabled         =   True
      Height          =   23
      HelpTag         =   "Items with a higher weight will be selected more frequently than items with a smaller weight. Two items with the same weight will be selected at the same frequency."
      Index           =   -2147483648
      InitialParent   =   ""
      Left            =   174
      LineStep        =   5
      LiveScroll      =   True
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   True
      LockTop         =   True
      Maximum         =   100
      Minimum         =   0
      PageStep        =   25
      Scope           =   2
      TabIndex        =   18
      TabPanelIndex   =   0
      TabStop         =   True
      TickStyle       =   "0"
      Top             =   176
      Value           =   25
      Visible         =   True
      Width           =   139
   End
   Begin UITweaks.ResizedTextField WeightField
      AcceptTabs      =   False
      Alignment       =   3
      AutoDeactivate  =   False
      AutomaticallyCheckSpelling=   False
      BackColor       =   &cFFFFFF00
      Bold            =   False
      Border          =   True
      CueText         =   ""
      DataField       =   ""
      DataSource      =   ""
      Enabled         =   True
      Format          =   ""
      Height          =   22
      HelpTag         =   ""
      Index           =   -2147483648
      Italic          =   False
      Left            =   325
      LimitText       =   3
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   False
      LockRight       =   True
      LockTop         =   True
      Mask            =   "99#"
      Password        =   False
      ReadOnly        =   False
      Scope           =   2
      TabIndex        =   19
      TabPanelIndex   =   0
      TabStop         =   True
      Text            =   "25"
      TextColor       =   &c00000000
      TextFont        =   "System"
      TextSize        =   0.0
      TextUnit        =   0
      Top             =   176
      Underline       =   False
      UseFocusRing    =   True
      Visible         =   True
      Width           =   53
   End
   Begin UITweaks.ResizedLabel WeightPercentLabel
      AutoDeactivate  =   True
      Bold            =   False
      DataField       =   ""
      DataSource      =   ""
      Enabled         =   True
      Height          =   22
      HelpTag         =   ""
      Index           =   -2147483648
      InitialParent   =   ""
      Italic          =   False
      Left            =   381
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   False
      LockRight       =   True
      LockTop         =   True
      Multiline       =   False
      Scope           =   2
      Selectable      =   False
      TabIndex        =   20
      TabPanelIndex   =   0
      Text            =   ""
      TextAlign       =   0
      TextColor       =   &c00000000
      TextFont        =   "System"
      TextSize        =   0.0
      TextUnit        =   0
      Top             =   176
      Transparent     =   True
      Underline       =   False
      Visible         =   True
      Width           =   37
   End
   Begin CheckBox EditWeightCheck
      AutoDeactivate  =   True
      Bold            =   False
      Caption         =   "Edit"
      DataField       =   ""
      DataSource      =   ""
      Enabled         =   True
      Height          =   23
      HelpTag         =   ""
      Index           =   -2147483648
      InitialParent   =   ""
      Italic          =   False
      Left            =   430
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   False
      LockRight       =   True
      LockTop         =   True
      Scope           =   2
      State           =   1
      TabIndex        =   21
      TabPanelIndex   =   0
      TabStop         =   True
      TextFont        =   "System"
      TextSize        =   0.0
      TextUnit        =   0
      Top             =   176
      Underline       =   False
      Value           =   True
      Visible         =   False
      Width           =   58
   End
End
#tag EndWindow

#tag WindowCode
	#tag Method, Flags = &h0
		Sub ApplyTo(Entries() As Beacon.SetEntry)
		  Dim MinQuantity As Integer = Val(MinQuantityField.Text)
		  Dim MaxQuantity As Integer = Val(MaxQuantityField.Text)
		  If MinQuantity > MaxQuantity Then
		    Dim Temp As Integer = MaxQuantity
		    MaxQuantity = MinQuantity
		    MinQuantity = Temp
		  End If
		  
		  Dim MinQualityValue As Double = MinQualityMenu.Tag
		  Dim MaxQualityValue As Double = MaxQualityMenu.Tag
		  If MinQualityValue > MaxQualityValue Then
		    Dim Temp As Double = MaxQualityValue
		    MaxQualityValue = MinQualityValue
		    MinQualityValue = Temp
		  End If
		  Dim MinQuality As Beacon.Quality = Beacon.Qualities.ForBaseValue(MinQualityValue)
		  Dim MaxQuality As Beacon.Quality = Beacon.Qualities.ForBaseValue(MaxQualityValue)
		  
		  For Each Entry As Beacon.SetEntry In Entries
		    If EditMaxQuantityCheck.Value Then
		      Entry.MaxQuantity = MaxQuantity
		    End If
		    If EditMinQuantityCheck.Value Then
		      Entry.MinQuantity = MinQuantity
		    End If
		    If EditChanceCheck.Value Then
		      Entry.ChanceToBeBlueprint = ChanceSlider.Value / 100
		    End If
		    If EditWeightCheck.Value Then
		      Entry.Weight = WeightSlider.Value / 100
		    End If
		    If EditMaxQualityCheck.Value Then
		      Entry.MaxQuality = MaxQuality
		    End If
		    If EditMinQualityCheck.Value Then
		      Entry.MinQuality = MinQuality
		    End If
		  Next
		End Sub
	#tag EndMethod

	#tag Method, Flags = &h0
		Sub ApplyTo(Entry As Beacon.SetEntry)
		  Dim Arr(0) As Beacon.SetEntry
		  Arr(0) = Entry
		  Self.ApplyTo(Arr)
		End Sub
	#tag EndMethod

	#tag Method, Flags = &h21
		Private Function MaxQualityMenu() As PopupMenu
		  Return Self.QualityMenus(1)
		End Function
	#tag EndMethod

	#tag Method, Flags = &h21
		Private Function MinQualityMenu() As PopupMenu
		  Return Self.QualityMenus(0)
		End Function
	#tag EndMethod

	#tag Method, Flags = &h0
		Sub Setup()
		  EditChanceCheck.Value = Not EditChanceCheck.Visible
		  EditWeightCheck.Value = Not EditWeightCheck.Visible
		  EditMaxQualityCheck.Value = Not EditMaxQualityCheck.Visible
		  EditMaxQuantityCheck.Value = Not EditMaxQuantityCheck.Visible
		  EditMinQualityCheck.Value = Not EditMinQualityCheck.Visible
		  EditMinQuantityCheck.Value = Not EditMaxQualityCheck.Visible
		  
		  Dim RightEdge As Integer
		  If EditMinQualityCheck.Visible Or EditMaxQualityCheck.Visible Or EditChanceCheck.Visible Or EditWeightCheck.Visible Then
		    RightEdge = Min(EditMinQualityCheck.Left, EditMaxQualityCheck.Left, EditChanceCheck.Left, EditWeightCheck.Left) - 12
		  Else
		    RightEdge = Self.Width - 20
		  End If
		  
		  MinQualityMenu.Width = (RightEdge - MinQualityMenu.Left)
		  MaxQualityMenu.Width = (RightEdge - MaxQualityMenu.Left)
		  ChancePercentLabel.Left = RightEdge - (ChancePercentLabel.Width + 3)
		  ChanceField.Left = ChancePercentLabel.Left - (ChanceField.Width + 12)
		  ChanceSlider.Width = ChanceField.Left - (12 + ChanceSlider.Left)
		  WeightPercentLabel.Left = ChancePercentLabel.Left
		  WeightField.Left = ChanceField.Left
		  WeightSlider.Width = ChanceSlider.Width
		End Sub
	#tag EndMethod

	#tag Method, Flags = &h0
		Sub Setup(Entries() As Beacon.SetEntry)
		  If Entries = Nil Then
		    Self.Setup()
		    Return
		  End If
		  
		  Dim MinQuantities(), MaxQuantities() As Integer
		  Dim MinQualities(), MaxQualities() As Double
		  Dim TotalWeight, TotalChance As Double
		  Dim CanBeBlueprint As Boolean
		  For Each Entry As Beacon.SetEntry In Entries
		    MinQuantities.Append(Entry.MinQuantity)
		    MaxQuantities.Append(Entry.MaxQuantity)
		    TotalWeight = TotalWeight + Entry.Weight
		    TotalChance = TotalChance + Entry.ChanceToBeBlueprint
		    MinQualities.Append(Entry.MinQuality.BaseValue)
		    MaxQualities.Append(Entry.MaxQuality.BaseValue)
		    CanBeBlueprint = CanBeBlueprint Or Entry.CanBeBlueprint
		  Next
		  
		  MinQuantities.Sort
		  MaxQuantities.Sort
		  MinQualities.Sort
		  MaxQualities.Sort
		  
		  Self.mIgnoreChanges = True
		  MinQuantityField.Text = Str(MinQuantities(0))
		  MaxQuantityField.Text = Str(MaxQuantities(UBound(MaxQuantities)))
		  If CanBeBlueprint Then
		    ChanceSlider.Value = 100 * (TotalChance / (UBound(Entries) + 1))
		    ChanceSlider.Enabled = True
		    ChanceLabel.Enabled = True
		    ChanceField.Enabled = True
		    EditChanceCheck.Enabled = True
		  Else
		    ChanceSlider.Value = 0
		    ChanceSlider.Enabled = False
		    ChanceLabel.Enabled = False
		    ChanceField.Enabled = False
		    EditChanceCheck.Enabled = False
		  End If
		  MinQualityMenu.SelectByTag(MinQualities(0))
		  MaxQualityMenu.SelectByTag(MaxQualities(UBound(MaxQualities)))
		  WeightSlider.Value = 100 * (TotalWeight / (UBound(Entries) + 1))
		  Self.mIgnoreChanges = False
		  
		  If UBound(Entries) > 0 Then
		    EditChanceCheck.Visible = True
		    EditMaxQualityCheck.Visible = True
		    EditMaxQuantityCheck.Visible = True
		    EditMinQualityCheck.Visible = True
		    EditMinQuantityCheck.Visible = True
		  End If
		  
		  Self.Setup()
		End Sub
	#tag EndMethod

	#tag Method, Flags = &h0
		Sub Setup(Entry As Beacon.SetEntry)
		  If Entry = Nil Then
		    Self.Setup()
		  Else
		    Dim Arr(0) As Beacon.SetEntry
		    Arr(0) = Entry
		    Self.Setup(Arr)
		  End If
		End Sub
	#tag EndMethod


	#tag Hook, Flags = &h0
		Event Changed()
	#tag EndHook


	#tag Property, Flags = &h21
		Private mIgnoreChanges As Boolean
	#tag EndProperty


#tag EndWindowCode

#tag Events ChanceField
	#tag Event
		Sub TextChange()
		  If Self.Focus = Me Then
		    ChanceSlider.Value = Max(Min(Val(Me.Text), ChanceSlider.Maximum), ChanceSlider.Minimum)
		  End If
		End Sub
	#tag EndEvent
	#tag Event
		Sub LostFocus()
		  Me.Text = Str(ChanceSlider.Value, "-0")
		  ChanceSlider.Enabled = True
		End Sub
	#tag EndEvent
	#tag Event
		Sub GotFocus()
		  ChanceSlider.Enabled = False
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events ChanceSlider
	#tag Event
		Sub ValueChanged()
		  If Self.Focus <> ChanceField Then
		    ChanceField.Text = Str(Me.Value, "-0")
		  End If
		  
		  If Not Self.mIgnoreChanges Then
		    EditChanceCheck.Value = True
		    RaiseEvent Changed
		  End If
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events QualityMenus
	#tag Event
		Sub Open(index as Integer)
		  Me.DeleteAllRows()
		  
		  Dim Qualities() As Beacon.Quality = Beacon.Qualities.All
		  For Each Quality As Beacon.Quality In Qualities
		    Me.AddRow(Language.LabelForQuality(Quality), Quality.BaseValue)
		  Next
		  
		  Me.ListIndex = 0
		End Sub
	#tag EndEvent
	#tag Event
		Sub Change(index as Integer)
		  If Not Self.mIgnoreChanges Then
		    Select Case Index
		    Case 0 // Min
		      EditMinQualityCheck.Value = True
		    Case 1 // Max
		      EditMaxQualityCheck.Value = True
		    End Select
		    RaiseEvent Changed
		  End If
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events MaxQuantityField
	#tag Event
		Sub TextChange()
		  If Not Self.mIgnoreChanges Then
		    EditMaxQuantityCheck.Value = True
		    RaiseEvent Changed
		  End If
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events MinQuantityField
	#tag Event
		Sub TextChange()
		  If Not Self.mIgnoreChanges Then
		    EditMinQuantityCheck.Value = True
		    RaiseEvent Changed
		  End If
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events WeightSlider
	#tag Event
		Sub ValueChanged()
		  If Self.Focus <> WeightField Then
		    WeightField.Text = Str(Me.Value, "-0")
		  End If
		  
		  If Not Self.mIgnoreChanges Then
		    EditWeightCheck.Value = True
		    RaiseEvent Changed
		  End If
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events WeightField
	#tag Event
		Sub TextChange()
		  If Self.Focus = Me Then
		    WeightSlider.Value = Max(Min(Val(Me.Text), WeightSlider.Maximum), WeightSlider.Minimum)
		  End If
		End Sub
	#tag EndEvent
	#tag Event
		Sub LostFocus()
		  Me.Text = Str(WeightSlider.Value, "-0")
		  WeightSlider.Enabled = True
		End Sub
	#tag EndEvent
	#tag Event
		Sub GotFocus()
		  WeightSlider.Enabled = False
		End Sub
	#tag EndEvent
#tag EndEvents
#tag ViewBehavior
	#tag ViewProperty
		Name="AcceptFocus"
		Visible=true
		Group="Behavior"
		InitialValue="False"
		Type="Boolean"
		EditorType="Boolean"
	#tag EndViewProperty
	#tag ViewProperty
		Name="AcceptTabs"
		Visible=true
		Group="Behavior"
		InitialValue="True"
		Type="Boolean"
		EditorType="Boolean"
	#tag EndViewProperty
	#tag ViewProperty
		Name="AutoDeactivate"
		Visible=true
		Group="Appearance"
		InitialValue="True"
		Type="Boolean"
	#tag EndViewProperty
	#tag ViewProperty
		Name="BackColor"
		Visible=true
		Group="Background"
		InitialValue="&hFFFFFF"
		Type="Color"
	#tag EndViewProperty
	#tag ViewProperty
		Name="Backdrop"
		Visible=true
		Group="Background"
		Type="Picture"
		EditorType="Picture"
	#tag EndViewProperty
	#tag ViewProperty
		Name="Enabled"
		Visible=true
		Group="Appearance"
		InitialValue="True"
		Type="Boolean"
		EditorType="Boolean"
	#tag EndViewProperty
	#tag ViewProperty
		Name="EraseBackground"
		Visible=true
		Group="Behavior"
		InitialValue="True"
		Type="Boolean"
		EditorType="Boolean"
	#tag EndViewProperty
	#tag ViewProperty
		Name="HasBackColor"
		Visible=true
		Group="Background"
		InitialValue="False"
		Type="Boolean"
	#tag EndViewProperty
	#tag ViewProperty
		Name="Height"
		Visible=true
		Group="Size"
		InitialValue="300"
		Type="Integer"
	#tag EndViewProperty
	#tag ViewProperty
		Name="HelpTag"
		Visible=true
		Group="Appearance"
		Type="String"
	#tag EndViewProperty
	#tag ViewProperty
		Name="InitialParent"
		Group="Position"
		Type="String"
	#tag EndViewProperty
	#tag ViewProperty
		Name="Left"
		Visible=true
		Group="Position"
		Type="Integer"
	#tag EndViewProperty
	#tag ViewProperty
		Name="LockBottom"
		Visible=true
		Group="Position"
		Type="Boolean"
	#tag EndViewProperty
	#tag ViewProperty
		Name="LockLeft"
		Visible=true
		Group="Position"
		Type="Boolean"
	#tag EndViewProperty
	#tag ViewProperty
		Name="LockRight"
		Visible=true
		Group="Position"
		Type="Boolean"
	#tag EndViewProperty
	#tag ViewProperty
		Name="LockTop"
		Visible=true
		Group="Position"
		Type="Boolean"
	#tag EndViewProperty
	#tag ViewProperty
		Name="Name"
		Visible=true
		Group="ID"
		Type="String"
		EditorType="String"
	#tag EndViewProperty
	#tag ViewProperty
		Name="Super"
		Visible=true
		Group="ID"
		Type="String"
		EditorType="String"
	#tag EndViewProperty
	#tag ViewProperty
		Name="TabIndex"
		Visible=true
		Group="Position"
		InitialValue="0"
		Type="Integer"
	#tag EndViewProperty
	#tag ViewProperty
		Name="TabPanelIndex"
		Group="Position"
		InitialValue="0"
		Type="Integer"
	#tag EndViewProperty
	#tag ViewProperty
		Name="TabStop"
		Visible=true
		Group="Position"
		InitialValue="True"
		Type="Boolean"
		EditorType="Boolean"
	#tag EndViewProperty
	#tag ViewProperty
		Name="Top"
		Visible=true
		Group="Position"
		Type="Integer"
	#tag EndViewProperty
	#tag ViewProperty
		Name="Transparent"
		Visible=true
		Group="Behavior"
		InitialValue="True"
		Type="Boolean"
		EditorType="Boolean"
	#tag EndViewProperty
	#tag ViewProperty
		Name="UseFocusRing"
		Visible=true
		Group="Appearance"
		InitialValue="False"
		Type="Boolean"
		EditorType="Boolean"
	#tag EndViewProperty
	#tag ViewProperty
		Name="Visible"
		Visible=true
		Group="Appearance"
		InitialValue="True"
		Type="Boolean"
		EditorType="Boolean"
	#tag EndViewProperty
	#tag ViewProperty
		Name="Width"
		Visible=true
		Group="Size"
		InitialValue="300"
		Type="Integer"
	#tag EndViewProperty
#tag EndViewBehavior
