#tag Window
Begin ContainerControl BeaconEditor
   AcceptFocus     =   False
   AcceptTabs      =   True
   AutoDeactivate  =   True
   BackColor       =   &cFFFFFF00
   Backdrop        =   0
   Compatibility   =   ""
   Enabled         =   True
   EraseBackground =   True
   HasBackColor    =   False
   Height          =   464
   HelpTag         =   ""
   InitialParent   =   ""
   Left            =   0
   LockBottom      =   True
   LockLeft        =   True
   LockRight       =   True
   LockTop         =   True
   TabIndex        =   0
   TabPanelIndex   =   0
   TabStop         =   True
   Top             =   0
   Transparent     =   True
   UseFocusRing    =   False
   Visible         =   True
   Width           =   598
   Begin TextField LabelField
      AcceptTabs      =   False
      Alignment       =   0
      AutoDeactivate  =   True
      AutomaticallyCheckSpelling=   False
      BackColor       =   &cFFFFFF00
      Bold            =   False
      Border          =   True
      CueText         =   ""
      DataField       =   ""
      DataSource      =   ""
      Enabled         =   True
      Format          =   ""
      Height          =   22
      HelpTag         =   ""
      Index           =   -2147483648
      Italic          =   False
      Left            =   102
      LimitText       =   0
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   True
      LockTop         =   True
      Mask            =   ""
      Password        =   False
      ReadOnly        =   False
      Scope           =   2
      TabIndex        =   0
      TabPanelIndex   =   0
      TabStop         =   True
      Text            =   ""
      TextColor       =   &c00000000
      TextFont        =   "System"
      TextSize        =   0.0
      TextUnit        =   0
      Top             =   20
      Underline       =   False
      UseFocusRing    =   True
      Visible         =   True
      Width           =   476
   End
   Begin Label LabelLabel
      AutoDeactivate  =   True
      Bold            =   False
      DataField       =   ""
      DataSource      =   ""
      Enabled         =   True
      Height          =   22
      HelpTag         =   ""
      Index           =   -2147483648
      InitialParent   =   ""
      Italic          =   False
      Left            =   20
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      Multiline       =   False
      Scope           =   2
      Selectable      =   False
      TabIndex        =   1
      TabPanelIndex   =   0
      TabStop         =   True
      Text            =   "Label:"
      TextAlign       =   2
      TextColor       =   &c00000000
      TextFont        =   "System"
      TextSize        =   0.0
      TextUnit        =   0
      Top             =   20
      Transparent     =   True
      Underline       =   False
      Visible         =   True
      Width           =   70
   End
   Begin TextField MinSetsField
      AcceptTabs      =   False
      Alignment       =   0
      AutoDeactivate  =   True
      AutomaticallyCheckSpelling=   False
      BackColor       =   &cFFFFFF00
      Bold            =   False
      Border          =   True
      CueText         =   ""
      DataField       =   ""
      DataSource      =   ""
      Enabled         =   True
      Format          =   ""
      Height          =   22
      HelpTag         =   ""
      Index           =   -2147483648
      Italic          =   False
      Left            =   102
      LimitText       =   0
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      Mask            =   "###"
      Password        =   False
      ReadOnly        =   False
      Scope           =   2
      TabIndex        =   2
      TabPanelIndex   =   0
      TabStop         =   True
      Text            =   ""
      TextColor       =   &c00000000
      TextFont        =   "System"
      TextSize        =   0.0
      TextUnit        =   0
      Top             =   54
      Underline       =   False
      UseFocusRing    =   True
      Visible         =   True
      Width           =   80
   End
   Begin Label BetweenLabel
      AutoDeactivate  =   True
      Bold            =   False
      DataField       =   ""
      DataSource      =   ""
      Enabled         =   True
      Height          =   22
      HelpTag         =   ""
      Index           =   -2147483648
      InitialParent   =   ""
      Italic          =   False
      Left            =   20
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      Multiline       =   False
      Scope           =   2
      Selectable      =   False
      TabIndex        =   3
      TabPanelIndex   =   0
      TabStop         =   True
      Text            =   "Min Sets:"
      TextAlign       =   2
      TextColor       =   &c00000000
      TextFont        =   "System"
      TextSize        =   0.0
      TextUnit        =   0
      Top             =   54
      Transparent     =   True
      Underline       =   False
      Visible         =   True
      Width           =   70
   End
   Begin TextField MaxSetsField
      AcceptTabs      =   False
      Alignment       =   0
      AutoDeactivate  =   True
      AutomaticallyCheckSpelling=   False
      BackColor       =   &cFFFFFF00
      Bold            =   False
      Border          =   True
      CueText         =   ""
      DataField       =   ""
      DataSource      =   ""
      Enabled         =   True
      Format          =   ""
      Height          =   22
      HelpTag         =   ""
      Index           =   -2147483648
      Italic          =   False
      Left            =   276
      LimitText       =   0
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      Mask            =   "###"
      Password        =   False
      ReadOnly        =   False
      Scope           =   2
      TabIndex        =   4
      TabPanelIndex   =   0
      TabStop         =   True
      Text            =   ""
      TextColor       =   &c00000000
      TextFont        =   "System"
      TextSize        =   0.0
      TextUnit        =   0
      Top             =   54
      Underline       =   False
      UseFocusRing    =   True
      Visible         =   True
      Width           =   80
   End
   Begin Label MaxSetsLabel
      AutoDeactivate  =   True
      Bold            =   False
      DataField       =   ""
      DataSource      =   ""
      Enabled         =   True
      Height          =   22
      HelpTag         =   ""
      Index           =   -2147483648
      InitialParent   =   ""
      Italic          =   False
      Left            =   194
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      Multiline       =   False
      Scope           =   2
      Selectable      =   False
      TabIndex        =   5
      TabPanelIndex   =   0
      TabStop         =   True
      Text            =   "Max Sets:"
      TextAlign       =   2
      TextColor       =   &c00000000
      TextFont        =   "System"
      TextSize        =   0.0
      TextUnit        =   0
      Top             =   54
      Transparent     =   True
      Underline       =   False
      Visible         =   True
      Width           =   70
   End
   Begin CheckBox DuplicatesCheck
      AutoDeactivate  =   True
      Bold            =   False
      Caption         =   "No duplicates"
      DataField       =   ""
      DataSource      =   ""
      Enabled         =   True
      Height          =   20
      HelpTag         =   ""
      Index           =   -2147483648
      InitialParent   =   ""
      Italic          =   False
      Left            =   102
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   True
      LockTop         =   True
      Scope           =   2
      State           =   1
      TabIndex        =   7
      TabPanelIndex   =   0
      TabStop         =   True
      TextFont        =   "System"
      TextSize        =   0.0
      TextUnit        =   0
      Top             =   88
      Underline       =   False
      Value           =   True
      Visible         =   True
      Width           =   446
   End
   Begin ControlCanvas Separators
      AcceptFocus     =   False
      AcceptTabs      =   False
      AutoDeactivate  =   True
      Backdrop        =   0
      DoubleBuffer    =   True
      Enabled         =   True
      EraseBackground =   False
      Height          =   1
      HelpTag         =   ""
      Index           =   0
      InitialParent   =   ""
      Left            =   0
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   True
      LockTop         =   True
      Scope           =   2
      TabIndex        =   9
      TabPanelIndex   =   0
      TabStop         =   True
      Top             =   120
      Transparent     =   False
      UseFocusRing    =   True
      Visible         =   True
      Width           =   598
   End
   Begin ClipboardListbox SetList
      AutoDeactivate  =   True
      AutoHideScrollbars=   True
      Bold            =   False
      Border          =   False
      ColumnCount     =   1
      ColumnsResizable=   False
      ColumnWidths    =   ""
      DataField       =   ""
      DataSource      =   ""
      DefaultRowHeight=   22
      Enabled         =   True
      EnableDrag      =   False
      EnableDragReorder=   False
      GridLinesHorizontal=   0
      GridLinesVertical=   0
      HasHeading      =   False
      HeadingIndex    =   -1
      Height          =   318
      HelpTag         =   ""
      Hierarchical    =   False
      Index           =   -2147483648
      InitialParent   =   ""
      InitialValue    =   ""
      Italic          =   False
      Left            =   0
      LockBottom      =   True
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      RequiresSelection=   False
      Scope           =   2
      ScrollbarHorizontal=   False
      ScrollBarVertical=   True
      SelectionType   =   0
      TabIndex        =   10
      TabPanelIndex   =   0
      TabStop         =   True
      TextFont        =   "System"
      TextSize        =   0.0
      TextUnit        =   0
      Top             =   121
      Underline       =   False
      UseFocusRing    =   False
      Visible         =   True
      Width           =   190
      _ScrollOffset   =   0
      _ScrollWidth    =   -1
   End
   Begin ControlCanvas Separators
      AcceptFocus     =   False
      AcceptTabs      =   False
      AutoDeactivate  =   True
      Backdrop        =   0
      DoubleBuffer    =   True
      Enabled         =   True
      EraseBackground =   False
      Height          =   343
      HelpTag         =   ""
      Index           =   1
      InitialParent   =   ""
      Left            =   190
      LockBottom      =   True
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      Scope           =   2
      TabIndex        =   11
      TabPanelIndex   =   0
      TabStop         =   True
      Top             =   121
      Transparent     =   False
      UseFocusRing    =   True
      Visible         =   True
      Width           =   1
   End
   Begin SetEditor Editor
      AcceptFocus     =   False
      AcceptTabs      =   True
      AutoDeactivate  =   True
      BackColor       =   &cFFFFFF00
      Backdrop        =   0
      Enabled         =   False
      EraseBackground =   True
      HasBackColor    =   False
      Height          =   343
      HelpTag         =   ""
      Index           =   -2147483648
      InitialParent   =   ""
      Left            =   191
      LockBottom      =   True
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   True
      LockTop         =   True
      Scope           =   2
      TabIndex        =   12
      TabPanelIndex   =   0
      TabStop         =   True
      Top             =   121
      Transparent     =   True
      UseFocusRing    =   False
      Visible         =   True
      Width           =   407
   End
   Begin ControlCanvas Separators
      AcceptFocus     =   False
      AcceptTabs      =   False
      AutoDeactivate  =   True
      Backdrop        =   0
      DoubleBuffer    =   True
      Enabled         =   True
      EraseBackground =   False
      Height          =   1
      HelpTag         =   ""
      Index           =   2
      InitialParent   =   ""
      Left            =   1
      LockBottom      =   True
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   False
      Scope           =   2
      TabIndex        =   13
      TabPanelIndex   =   0
      TabStop         =   True
      Top             =   439
      Transparent     =   False
      UseFocusRing    =   True
      Visible         =   True
      Width           =   190
   End
   Begin GraphicButton AddSetButton
      AcceptFocus     =   False
      AcceptTabs      =   False
      AutoDeactivate  =   True
      Backdrop        =   0
      DoubleBuffer    =   False
      Enabled         =   True
      EraseBackground =   True
      Height          =   24
      HelpTag         =   "Add an item set to this beacon. Click to add an empty set, hold to show a menu of presets."
      IconDisabled    =   0
      IconNormal      =   0
      IconPressed     =   0
      Index           =   -2147483648
      InitialParent   =   ""
      Left            =   0
      LockBottom      =   True
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   False
      Scope           =   2
      TabIndex        =   14
      TabPanelIndex   =   0
      TabStop         =   True
      Top             =   440
      Transparent     =   True
      UseFocusRing    =   True
      Visible         =   True
      Width           =   30
   End
   Begin GraphicButton RemoveSetButton
      AcceptFocus     =   False
      AcceptTabs      =   False
      AutoDeactivate  =   True
      Backdrop        =   0
      DoubleBuffer    =   False
      Enabled         =   False
      EraseBackground =   True
      Height          =   24
      HelpTag         =   "Remove the selected item set."
      IconDisabled    =   0
      IconNormal      =   0
      IconPressed     =   0
      Index           =   -2147483648
      InitialParent   =   ""
      Left            =   31
      LockBottom      =   True
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   False
      Scope           =   2
      TabIndex        =   15
      TabPanelIndex   =   0
      TabStop         =   True
      Top             =   440
      Transparent     =   True
      UseFocusRing    =   True
      Visible         =   True
      Width           =   30
   End
   Begin FooterBar FooterBar1
      AcceptFocus     =   False
      AcceptTabs      =   False
      AutoDeactivate  =   True
      Backdrop        =   0
      DoubleBuffer    =   False
      Enabled         =   True
      EraseBackground =   True
      Height          =   24
      HelpTag         =   ""
      Index           =   -2147483648
      InitialParent   =   ""
      Left            =   62
      LockBottom      =   True
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   False
      Scope           =   2
      TabIndex        =   16
      TabPanelIndex   =   0
      TabStop         =   True
      Top             =   440
      Transparent     =   True
      UseFocusRing    =   True
      Visible         =   True
      Width           =   128
   End
   Begin ControlCanvas Separators
      AcceptFocus     =   False
      AcceptTabs      =   False
      AutoDeactivate  =   True
      Backdrop        =   0
      DoubleBuffer    =   True
      Enabled         =   True
      EraseBackground =   False
      Height          =   24
      HelpTag         =   ""
      Index           =   3
      InitialParent   =   ""
      Left            =   30
      LockBottom      =   True
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   False
      Scope           =   2
      TabIndex        =   17
      TabPanelIndex   =   0
      TabStop         =   True
      Top             =   440
      Transparent     =   False
      UseFocusRing    =   True
      Visible         =   True
      Width           =   1
   End
   Begin ControlCanvas Separators
      AcceptFocus     =   False
      AcceptTabs      =   False
      AutoDeactivate  =   True
      Backdrop        =   0
      DoubleBuffer    =   True
      Enabled         =   True
      EraseBackground =   False
      Height          =   24
      HelpTag         =   ""
      Index           =   4
      InitialParent   =   ""
      Left            =   61
      LockBottom      =   True
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   False
      Scope           =   2
      TabIndex        =   18
      TabPanelIndex   =   0
      TabStop         =   True
      Top             =   440
      Transparent     =   False
      UseFocusRing    =   True
      Visible         =   True
      Width           =   1
   End
End
#tag EndWindow

#tag WindowCode
	#tag MenuHandler
		Function AddItemSetAdobeHousing() As Boolean Handles AddItemSetAdobeHousing.Action
			Dim Set As New Ark.ItemSet
			Set.Label = "Adobe Housing"
			Set.MinNumItems = 2
			Set.MaxNumItems = 6
			
			Self.AddTemplate(Set, "PrimalItemStructure_AdobeFloor_C", 1, 16)
			Self.AddTemplate(Set, "PrimalItemStructure_AdobeWall_C", 1, 32)
			Self.AddTemplate(Set, "PrimalItemStructure_AdobeCeiling_C", 1, 16)
			Self.AddTemplate(Set, "PrimalItemStructure_AdobeWallWithDoor_C", 1, 2, 0.75)
			Self.AddTemplate(Set, "PrimalItemStructure_AdobeDoor_C", 1, 2, 0.75)
			Self.AddTemplate(Set, "PrimalItemStructure_AdobeWall_Sloped_Right_C", 2, 4, 0.5)
			Self.AddTemplate(Set, "PrimalItemStructure_AdobeWall_Sloped_Left_C", 2, 4, 0.5)
			Self.AddTemplate(Set, "PrimalItemStructure_AdobeRoof_C", 1, 16, 0.5)
			Self.AddTemplate(Set, "PrimalItemStructure_AdobeRamp_C", 1, 1, 0.25)
			Self.AddTemplate(Set, "PrimalItemStructure_AdobeWallWithWindow_C", 1, 4, 0.5)
			Self.AddTemplate(Set, "PrimalItemStructure_AdobeWindow_C", 1, 4, 0.5)
			
			Self.AddSet(Set)
			Return True
		End Function
	#tag EndMenuHandler

	#tag MenuHandler
		Function AddItemSetAdvancedFirearms() As Boolean Handles AddItemSetAdvancedFirearms.Action
			Dim Set As New Ark.ItemSet
			Set.Label = "Advanced Firearms"
			Set.MinNumItems = 1
			Set.MaxNumItems = 2
			
			Dim MinQuality, MaxQuality, AmmoMultiplier As Double
			If Self.mBeacon.IsBonus Then
			MinQuality = Ark.QualityJourneyman
			MaxQuality = Ark.QualityAscendant
			AmmoMultiplier = 2
			Else
			MinQuality = Ark.QualityPrimitive
			MaxQuality = Ark.QualityApprentice
			AmmoMultiplier = 1
			End If
			
			Self.AddTemplate(Set, "PrimalItem_WeaponRifle_C", 1, 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItem_WeaponRocketLauncher_C", 1, 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItem_WeaponMachinedPistol_C", 1, 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItem_WeaponMachinedShotgun_C", 1, 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItem_WeaponCompoundBow_C", 1, 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItem_WeaponMachinedSniper_C", 1, 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItem_WeapFlamethrower_C", 1, 1, 1, MinQuality, MaxQuality)
			
			Self.AddTemplate(Set, "PrimalItem_WeaponClusterGrenade_C", 2 * AmmoMultiplier, 6 * AmmoMultiplier)
			
			Self.AddTemplate(Set, "PrimalItemAmmo_AdvancedBullet_C", 13 * AmmoMultiplier, 52 * AmmoMultiplier)
			Self.AddTemplate(Set, "PrimalItemAmmo_AdvancedRifleBullet_C", 40 * AmmoMultiplier, 160 * AmmoMultiplier)
			Self.AddTemplate(Set, "PrimalItemAmmo_Rocket_C", 1 * AmmoMultiplier, 4 * AmmoMultiplier)
			Self.AddTemplate(Set, "PrimalItemAmmo_SimpleShotgunBullet_C", 6 * AmmoMultiplier, 24 * AmmoMultiplier)
			Self.AddTemplate(Set, "PrimalItemAmmo_AdvancedSniperBullet_C", 8 * AmmoMultiplier, 32 * AmmoMultiplier)
			Self.AddTemplate(Set, "PrimalItemAmmo_RocketHomingMissile_C", 1 * AmmoMultiplier, 4 * AmmoMultiplier)
			Self.AddTemplate(Set, "PrimalItemAmmo_Flamethrower_C", 2 * AmmoMultiplier, 8 * AmmoMultiplier)
			Self.AddTemplate(Set, "PrimalItemAmmo_CompoundBowArrow_C", 10 * AmmoMultiplier, 40 * AmmoMultiplier)
			Self.AddTemplate(Set, "PrimalItemAmmo_TranqDart_C", 10 * AmmoMultiplier, 40 * AmmoMultiplier)
			
			Self.AddSet(Set)
			Return True
		End Function
	#tag EndMenuHandler

	#tag MenuHandler
		Function AddItemSetAdvancedFurniture() As Boolean Handles AddItemSetAdvancedFurniture.Action
			Dim Set As New Ark.ItemSet
			Set.Label = "Advanced Furniture"
			If Self.mBeacon.IsBonus Then
			Set.MinNumItems = 2
			Set.MaxNumItems = 8
			Else
			Set.MinNumItems = 1
			Set.MaxNumItems = 4
			End If
			
			Self.AddTemplate(Set, "PrimalItemStructure_Fabricator_C", 1, 1)
			Self.AddTemplate(Set, "PrimalItemStructure_AirConditioner_C", 1, 3)
			Self.AddTemplate(Set, "PrimalItemStructure_PowerGenerator_C", 1, 1)
			Self.AddTemplate(Set, "PrimalItemStructure_PowerOutlet_C", 3, 9)
			Self.AddTemplate(Set, "PrimalItemStructure_PowerCableIncline_C", 3, 9)
			Self.AddTemplate(Set, "PrimalItemStructure_PowerCableIntersection_C", 3, 9)
			Self.AddTemplate(Set, "PrimalItemStructure_PowerCableStraight_C", 5, 20)
			Self.AddTemplate(Set, "PrimalItemStructure_PowerCableVertical_C", 3, 9)
			Self.AddTemplate(Set, "PrimalItemStructure_Lamppost_C", 1, 5)
			Self.AddTemplate(Set, "PrimalItemStructure_IceBox_C", 1, 3)
			Self.AddTemplate(Set, "PrimalItemStructure_Turret_C", 1, 1)
			Self.AddTemplate(Set, "PrimalItemStructure_Keypad_C", 1, 1)
			Self.AddTemplate(Set, "PrimalItemStructure_StorageBox_Huge_C", 1, 1)
			Self.AddTemplate(Set, "PrimalItemStructure_LamppostOmni_C", 1, 5)
			Self.AddTemplate(Set, "PrimalItemStructure_Grill_C", 1, 1)
			Self.AddTemplate(Set, "PrimalItemStructure_TurretBallista_C", 1, 1)
			Self.AddTemplate(Set, "PrimalItemStructure_TurretMinigun_C", 1, 1)
			Self.AddTemplate(Set, "PrimalItemStructure_TurretCatapult_C", 1, 1)
			Self.AddTemplate(Set, "PrimalItemStructure_TurretRocket_C", 1, 1)
			Self.AddTemplate(Set, "PrimalItemStructure_IndustrialForge_C", 1, 1)
			Self.AddTemplate(Set, "PrimalItemStructure_IndustrialCookingPot_C", 1, 1)
			Self.AddTemplate(Set, "PrimalItemStructure_Bed_Modern_C", 1, 1)
			Self.AddTemplate(Set, "PrimalItemStructure_ChemBench_C", 1, 1)
			Self.AddTemplate(Set, "PrimalItemStructure_Cannon_C", 1, 1)
			
			If Self.mBeacon.IsScorchedEarth Then
			Self.AddTemplate(Set, "PrimalItemStructure_oilPump_C", 1, 1)
			Self.AddTemplate(Set, "PrimalItemStructure_WindTurbine_C", 1, 1)
			End If
			
			Self.AddSet(Set)
			Return True
		End Function
	#tag EndMenuHandler

	#tag MenuHandler
		Function AddItemSetBasicFurniture() As Boolean Handles AddItemSetBasicFurniture.Action
			Dim Set As New Ark.ItemSet
			Set.Label = "Basic Furniture"
			If Self.mBeacon.IsBonus Then
			Set.MinNumItems = 2
			Set.MaxNumItems = 8
			Else
			Set.MinNumItems = 1
			Set.MaxNumItems = 4
			End If
			
			Self.AddTemplate(Set, "PrimalItemStructure_Campfire_C", 1, 3)
			Self.AddTemplate(Set, "PrimalItemStructure_StandingTorch_C", 1, 3)
			Self.AddTemplate(Set, "PrimalItemStructure_SleepingBag_Hide_C", 1, 3)
			Self.AddTemplate(Set, "PrimalItemStructure_StorageBox_Small_C", 1, 5)
			Self.AddTemplate(Set, "PrimalItemStructure_StorageBox_Large_C", 1, 5)
			Self.AddTemplate(Set, "PrimalItemStructure_MortarAndPestle_C", 1, 1)
			Self.AddTemplate(Set, "PrimalItemStructure_Forge_C", 1, 1)
			Self.AddTemplate(Set, "PrimalItemStructure_AnvilBench_C", 1, 1)
			Self.AddTemplate(Set, "PrimalItemStructure_CompostBin_C", 1, 1)
			Self.AddTemplate(Set, "PrimalItemStructure_CookingPot_C", 1, 1)
			Self.AddTemplate(Set, "PrimalItemStructure_Bed_Simple_C", 1, 1)
			Self.AddTemplate(Set, "PrimalItemStructure_FeedingTrough_C", 1, 1)
			Self.AddTemplate(Set, "PrimalItemStructure_WallTorch_C", 1, 3)
			Self.AddTemplate(Set, "PrimalItemStructure_PreservingBin_C", 1, 3)
			Self.AddTemplate(Set, "PrimalItemStructure_Bookshelf_C", 1, 1)
			
			If Self.mBeacon.IsScorchedEarth Then
			Self.AddTemplate(Set, "PrimalItemStructure_Tent_C", 1, 1)
			Self.AddTemplate(Set, "PrimalItemStructure_Vessel_C", 1, 1)
			Self.AddTemplate(Set, "PrimalItemStructure_WaterWell_C", 1, 1)
			End If
			
			Self.AddSet(Set)
			Return True
		End Function
	#tag EndMenuHandler

	#tag MenuHandler
		Function AddItemSetChitinArmor() As Boolean Handles AddItemSetChitinArmor.Action
			Dim Set As New Ark.ItemSet
			Set.Label = "Chitin Armor"
			Dim MinQuality, MaxQuality As Double
			If Self.mBeacon.IsBonus Then
			MinQuality = Ark.QualityJourneyman
			MaxQuality = Ark.QualityAscendant
			Else
			MinQuality = Ark.QualityPrimitive
			MaxQuality = Ark.QualityApprentice
			End If
			Set.MinNumItems = 1
			Set.MaxNumItems = 5
			
			Self.AddTemplate(Set, "PrimalItemArmor_ChitinPants_C", 1, 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItemArmor_ChitinShirt_C", 1, 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItemArmor_ChitinHelmet_C", 1, 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItemArmor_ChitinBoots_C", 1, 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItemArmor_ChitinGloves_C", 1, 1, 1, MinQuality, MaxQuality)
			
			Self.AddSet(Set)
			Return True
		End Function
	#tag EndMenuHandler

	#tag MenuHandler
		Function AddItemSetClothClothing() As Boolean Handles AddItemSetClothClothing.Action
			Dim Set As New Ark.ItemSet
			Set.Label = "Cloth Clothing"
			Dim MinQuality, MaxQuality As Double
			If Self.mBeacon.IsBonus Then
			MinQuality = Ark.QualityJourneyman
			MaxQuality = Ark.QualityAscendant
			Else
			MinQuality = Ark.QualityPrimitive
			MaxQuality = Ark.QualityApprentice
			End If
			Set.MinNumItems = 1
			Set.MaxNumItems = 5
			
			Self.AddTemplate(Set, "PrimalItemArmor_ClothPants_C", 1, 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItemArmor_ClothShirt_C", 1, 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItemArmor_ClothHelmet_C", 1, 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItemArmor_ClothBoots_C", 1, 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItemArmor_ClothGloves_C", 1, 1, 1, MinQuality, MaxQuality)
			
			Self.AddSet(Set)
			Return True
		End Function
	#tag EndMenuHandler

	#tag MenuHandler
		Function AddItemSetDesertClothClothing() As Boolean Handles AddItemSetDesertClothClothing.Action
			Dim Set As New Ark.ItemSet
			Set.Label = "Desert Cloth Clothing"
			Dim MinQuality, MaxQuality As Double
			If Self.mBeacon.IsBonus Then
			MinQuality = Ark.QualityJourneyman
			MaxQuality = Ark.QualityAscendant
			Else
			MinQuality = Ark.QualityPrimitive
			MaxQuality = Ark.QualityApprentice
			End If
			Set.MinNumItems = 1
			Set.MaxNumItems = 5
			
			Self.AddTemplate(Set, "PrimalItemArmor_DesertClothPants_C", 1, 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItemArmor_DesertClothShirt_C", 1, 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItemArmor_DesertClothGogglesHelmet_C", 1, 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItemArmor_DesertClothBoots_C", 1, 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItemArmor_DesertClothGloves_C", 1, 1, 1, MinQuality, MaxQuality)
			
			Self.AddSet(Set)
			Return True
		End Function
	#tag EndMenuHandler

	#tag MenuHandler
		Function AddItemSetEmpty() As Boolean Handles AddItemSetEmpty.Action
			Self.AddSet(New Ark.ItemSet)
			Return True
			
		End Function
	#tag EndMenuHandler

	#tag MenuHandler
		Function AddItemSetFlakArmor() As Boolean Handles AddItemSetFlakArmor.Action
			Dim Set As New Ark.ItemSet
			Set.Label = "Flak Armor"
			Dim MinQuality, MaxQuality As Double
			If Self.mBeacon.IsBonus Then
			MinQuality = Ark.QualityJourneyman
			MaxQuality = Ark.QualityAscendant
			Else
			MinQuality = Ark.QualityPrimitive
			MaxQuality = Ark.QualityApprentice
			End If
			Set.MinNumItems = 1
			Set.MaxNumItems = 5
			
			Self.AddTemplate(Set, "PrimalItemArmor_MetalPants_C", 1, 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItemArmor_MetalShirt_C", 1, 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItemArmor_MetalHelmet_C", 1, 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItemArmor_MetalBoots_C", 1, 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItemArmor_MetalGloves_C", 1, 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItemArmor_MetalShield_C", 1, 1, 1, MinQuality, MaxQuality)
			
			Self.AddSet(Set)
			Return True
		End Function
	#tag EndMenuHandler

	#tag MenuHandler
		Function AddItemSetFurArmor() As Boolean Handles AddItemSetFurArmor.Action
			Dim Set As New Ark.ItemSet
			Set.Label = "Flak Clothing"
			Dim MinQuality, MaxQuality As Double
			If Self.mBeacon.IsBonus Then
			MinQuality = Ark.QualityJourneyman
			MaxQuality = Ark.QualityAscendant
			Else
			MinQuality = Ark.QualityPrimitive
			MaxQuality = Ark.QualityApprentice
			End If
			Set.MinNumItems = 1
			Set.MaxNumItems = 5
			
			Self.AddTemplate(Set, "PrimalItemArmor_FurPants_C", 1, 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItemArmor_FurShirt_C", 1, 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItemArmor_FurHelmet_C", 1, 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItemArmor_FurBoots_C", 1, 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItemArmor_FurGloves_C", 1, 1, 1, MinQuality, MaxQuality)
			
			Self.AddSet(Set)
			Return True
		End Function
	#tag EndMenuHandler

	#tag MenuHandler
		Function AddItemSetGardening() As Boolean Handles AddItemSetGardening.Action
			Dim Set As New Ark.ItemSet
			Set.Label = "Gardening"
			If Self.mBeacon.IsBonus Then
			Set.MinNumItems = 2
			Set.MaxNumItems = 8
			Else
			Set.MinNumItems = 1
			Set.MaxNumItems = 4
			End If
			
			Self.AddTemplate(Set, "PrimalItemConsumable_Seed_Amarberry_C", 10, 20)
			Self.AddTemplate(Set, "PrimalItemConsumable_Seed_Citronal_C", 10, 20)
			Self.AddTemplate(Set, "PrimalItemConsumable_Seed_Azulberry_C", 10, 20)
			Self.AddTemplate(Set, "PrimalItemConsumable_Seed_Tintoberry_C", 10, 20)
			Self.AddTemplate(Set, "PrimalItemConsumable_Seed_Mejoberry_C", 10, 20)
			Self.AddTemplate(Set, "PrimalItemConsumable_Seed_Narcoberry_C", 10, 20)
			Self.AddTemplate(Set, "PrimalItemConsumable_Seed_Stimberry_C", 10, 20)
			Self.AddTemplate(Set, "PrimalItemConsumable_Seed_Savoroot_C", 10, 20)
			Self.AddTemplate(Set, "PrimalItemConsumable_Seed_Longrass_C", 10, 20)
			Self.AddTemplate(Set, "PrimalItemConsumable_Seed_Rockarrot_C", 10, 20)
			If Self.mBeacon.IsScorchedEarth Then
			Self.AddTemplate(Set, "PrimalItemConsumable_Seed_PlantSpeciesY_C", 100, 100)
			Else
			Self.AddTemplate(Set, "PrimalItemConsumable_Seed_DefensePlant_C", 100, 100)
			End If
			
			Self.AddTemplate(Set, "PrimalItemStructure_CropPlot_Small_C", 1, 10)
			Self.AddTemplate(Set, "PrimalItemStructure_CropPlot_Medium_C", 1, 10)
			Self.AddTemplate(Set, "PrimalItemStructure_CropPlot_Large_C", 1, 10)
			
			Self.AddSet(Set)
			Return True
		End Function
	#tag EndMenuHandler

	#tag MenuHandler
		Function AddItemSetGhillieSuit() As Boolean Handles AddItemSetGhillieSuit.Action
			Dim Set As New Ark.ItemSet
			Set.Label = "Ghillie Suit"
			Dim MinQuality, MaxQuality As Double
			If Self.mBeacon.IsBonus Then
			MinQuality = Ark.QualityJourneyman
			MaxQuality = Ark.QualityAscendant
			Else
			MinQuality = Ark.QualityPrimitive
			MaxQuality = Ark.QualityApprentice
			End If
			Set.MinNumItems = 1
			Set.MaxNumItems = 5
			
			Self.AddTemplate(Set, "PrimalItemArmor_GhilliePants_C", 1, 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItemArmor_GhillieShirt_C", 1, 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItemArmor_GhillieHelmet_C", 1, 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItemArmor_GhillieBoots_C", 1, 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItemArmor_GhillieGloves_C", 1, 1, 1, MinQuality, MaxQuality)
			
			Self.AddSet(Set)
			Return True
		End Function
	#tag EndMenuHandler

	#tag MenuHandler
		Function AddItemSetHideClothing() As Boolean Handles AddItemSetHideClothing.Action
			Dim Set As New Ark.ItemSet
			Set.Label = "Hide Clothing"
			Dim MinQuality, MaxQuality As Double
			If Self.mBeacon.IsBonus Then
			MinQuality = Ark.QualityJourneyman
			MaxQuality = Ark.QualityAscendant
			Else
			MinQuality = Ark.QualityPrimitive
			MaxQuality = Ark.QualityApprentice
			End If
			Set.MinNumItems = 1
			Set.MaxNumItems = 5
			
			Self.AddTemplate(Set, "PrimalItemArmor_HidePants_C", 1, 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItemArmor_HideShirt_C", 1, 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItemArmor_HideHelmet_C", 1, 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItemArmor_HideBoots_C", 1, 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItemArmor_HideGloves_C", 1, 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItemArmor_WoodShield_C", 1, 1, 1, MinQuality, MaxQuality)
			
			Self.AddSet(Set)
			Return True
		End Function
	#tag EndMenuHandler

	#tag MenuHandler
		Function AddItemSetLargeSaddles() As Boolean Handles AddItemSetLargeSaddles.Action
			Dim Set As New Ark.ItemSet
			Set.Label = "Large Saddles"
			Set.MinNumItems = 1
			Set.MaxNumItems = 2
			
			Dim MinQuality, MaxQuality As Double
			If Self.mBeacon.IsBonus Then
			MinQuality = Ark.QualityJourneyman
			MaxQuality = Ark.QualityAscendant
			Else
			MinQuality = Ark.QualityPrimitive
			MaxQuality = Ark.QualityApprentice
			End If
			
			Self.AddTemplate(Set, "PrimalItemArmor_RexSaddle_C", 1, 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItemArmor_Paracer_Saddle_C", 1, 1, 1, MinQuality, MaxQuality)
			
			If Self.mBeacon.IsScorchedEarth Then
			Self.AddTemplate(Set, "PrimalItemArmor_RockGolemSaddle_C", 1, 1, 1, MinQuality, MaxQuality)
			Else
			Self.AddTemplate(Set, "PrimalItemArmor_AlloSaddle_C", 1, 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItemArmor_SpinoSaddle_C", 1, 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItemArmor_SauroSaddle_C", 1, 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItemArmor_GigantSaddle_C", 1, 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItemArmor_MosaSaddle_C", 1, 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItemArmor_DunkleosteusSaddle_C", 1, 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItemArmor_DiplodocusSaddle_C", 1, 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItemArmor_PlesiaSaddle_C", 1, 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItemArmor_QuetzSaddle_C", 1, 1, 1, MinQuality, MaxQuality)
			End If
			
			Self.AddSet(Set)
			Return True
		End Function
	#tag EndMenuHandler

	#tag MenuHandler
		Function AddItemSetMediumSaddles() As Boolean Handles AddItemSetMediumSaddles.Action
			Dim Set As New Ark.ItemSet
			Set.Label = "Medium Saddles"
			Set.MinNumItems = 1
			Set.MaxNumItems = 2
			
			Dim MinQuality, MaxQuality As Double
			If Self.mBeacon.IsBonus Then
			MinQuality = Ark.QualityJourneyman
			MaxQuality = Ark.QualityAscendant
			Else
			MinQuality = Ark.QualityPrimitive
			MaxQuality = Ark.QualityApprentice
			End If
			
			Self.AddTemplate(Set, "PrimalItemArmor_DoedSaddle_C", 1, 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItemArmor_CarnoSaddle_C", 1, 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItemArmor_Gallimimus_C", 1, 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItemArmor_AnkyloSaddle_C", 1, 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItemArmor_ArgentavisSaddle_C", 1, 1, 1, MinQuality, MaxQuality)
			
			If Self.mBeacon.IsScorchedEarth Then
			Self.AddTemplate(Set, "PrimalItemArmor_CamelsaurusSaddle_C", 1, 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItemArmor_MantisSaddle_C", 1, 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItemArmor_SpineyLizardSaddle_C", 1, 1, 1, MinQuality, MaxQuality)
			Else
			Self.AddTemplate(Set, "PrimalItemArmor_TrikeSaddle_C", 1, 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItemArmor_MammothSaddle_C", 1, 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItemArmor_RhinoSaddle_C", 1, 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItemArmor_SarcoSaddle_C", 1, 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItemArmor_StegoSaddle_C", 1, 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItemArmor_ParaSaddle_C", 1, 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItemArmor_DireBearSaddle_C", 1, 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItemArmor_TurtleSaddle_C", 1, 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItemArmor_MegalodonSaddle_C", 1, 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItemArmor_PelaSaddle_C", 1, 1, 1, MinQuality, MaxQuality)
			End If
			
			Self.AddSet(Set)
			Return True
		End Function
	#tag EndMenuHandler

	#tag MenuHandler
		Function AddItemSetMetalHousing() As Boolean Handles AddItemSetMetalHousing.Action
			Dim Set As New Ark.ItemSet
			Set.Label = "Metal Housing"
			Set.MinNumItems = 2
			Set.MaxNumItems = 6
			
			Self.AddTemplate(Set, "PrimalItemStructure_MetalFloor_C", 1, 16)
			Self.AddTemplate(Set, "PrimalItemStructure_MetalWall_C", 1, 32)
			Self.AddTemplate(Set, "PrimalItemStructure_MetalCeiling_C", 1, 16)
			Self.AddTemplate(Set, "PrimalItemStructure_MetalWallWithDoor_C", 1, 2, 0.75)
			Self.AddTemplate(Set, "PrimalItemStructure_MetalDoor_C", 1, 2, 0.75)
			Self.AddTemplate(Set, "PrimalItemStructure_MetalWall_Sloped_Right_C", 2, 4, 0.5)
			Self.AddTemplate(Set, "PrimalItemStructure_MetalWall_Sloped_Left_C", 2, 4, 0.5)
			Self.AddTemplate(Set, "PrimalItemStructure_MetalRoof_C", 1, 16, 0.5)
			Self.AddTemplate(Set, "PrimalItemStructure_MetalRamp_C", 1, 1, 0.25)
			Self.AddTemplate(Set, "PrimalItemStructure_MetalWallWithWindow_C", 1, 4, 0.5)
			Self.AddTemplate(Set, "PrimalItemStructure_MetalWindow_C", 1, 4, 0.5)
			
			Self.AddSet(Set)
			Return True
		End Function
	#tag EndMenuHandler

	#tag MenuHandler
		Function AddItemSetMetalTools() As Boolean Handles AddItemSetMetalTools.Action
			Dim Set As New Ark.ItemSet
			Set.Label = "Advanced Tools"
			Set.MinNumItems = 1
			Set.MaxNumItems = 2
			
			Dim MinQuality, MaxQuality As Double
			If Self.mBeacon.IsBonus Then
			MinQuality = Ark.QualityJourneyman
			MaxQuality = Ark.QualityAscendant
			Else
			MinQuality = Ark.QualityPrimitive
			MaxQuality = Ark.QualityApprentice
			End If
			
			Self.AddTemplate(Set, "PrimalItem_WeaponMetalPick_C", 1, 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItem_WeaponMetalHatchet_C", 1, 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItem_WeaponGPS_C", 1, 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItemRadio_C", 1, 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItem_WeaponSickle_C", 1, 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItem_ChainSaw_C", 1, 1, 1, MinQuality, MaxQuality)
			
			Self.AddSet(Set)
			Return True
		End Function
	#tag EndMenuHandler

	#tag MenuHandler
		Function AddItemSetPlatformSaddles() As Boolean Handles AddItemSetPlatformSaddles.Action
			Dim Set As New Ark.ItemSet
			Set.Label = "Platform Saddles"
			Set.MinNumItems = 1
			Set.MaxNumItems = 2
			
			Dim MinQuality, MaxQuality As Double
			If Self.mBeacon.IsBonus Then
			MinQuality = Ark.QualityJourneyman
			MaxQuality = Ark.QualityAscendant
			Else
			MinQuality = Ark.QualityPrimitive
			MaxQuality = Ark.QualityApprentice
			End If
			
			Self.AddTemplate(Set, "PrimalItemArmor_SauroSaddle_Platform_C", 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItemArmor_ParacerSaddle_Platform_C", 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItemArmor_PlesiSaddle_Platform_C", 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItemArmor_QuetzSaddle_Platform_C", 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItemArmor_MosaSaddle_Platform_C", 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItemArmor_TitanSaddle_Platform_C", 1, 1, MinQuality, MaxQuality)
			
			Self.AddSet(Set)
			Return True
		End Function
	#tag EndMenuHandler

	#tag MenuHandler
		Function AddItemSetRiotArmor() As Boolean Handles AddItemSetRiotArmor.Action
			Dim Set As New Ark.ItemSet
			Set.Label = "Riot Armor"
			Dim MinQuality, MaxQuality As Double
			If Self.mBeacon.IsBonus Then
			MinQuality = Ark.QualityJourneyman
			MaxQuality = Ark.QualityAscendant
			Else
			MinQuality = Ark.QualityPrimitive
			MaxQuality = Ark.QualityApprentice
			End If
			Set.MinNumItems = 1
			Set.MaxNumItems = 5
			
			Self.AddTemplate(Set, "PrimalItemArmor_RiotPants_C", 1, 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItemArmor_RiotShirt_C", 1, 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItemArmor_RiotHelmet_C", 1, 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItemArmor_RiotBoots_C", 1, 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItemArmor_RiotGloves_C", 1, 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItemArmor_TransparentRiotShield_C", 1, 1, 1, MinQuality, MaxQuality)
			
			Self.AddSet(Set)
			Return True
		End Function
	#tag EndMenuHandler

	#tag MenuHandler
		Function AddItemSetSimpleFirearms() As Boolean Handles AddItemSetSimpleFirearms.Action
			Dim Set As New Ark.ItemSet
			Set.Label = "Simple Firearms"
			Set.MinNumItems = 1
			Set.MaxNumItems = 2
			
			Dim MinQuality, MaxQuality, AmmoMultiplier As Double
			If Self.mBeacon.IsBonus Then
			MinQuality = Ark.QualityJourneyman
			MaxQuality = Ark.QualityAscendant
			AmmoMultiplier = 2
			Else
			MinQuality = Ark.QualityPrimitive
			MaxQuality = Ark.QualityApprentice
			AmmoMultiplier = 1
			End If
			
			Self.AddTemplate(Set, "PrimalItem_WeaponCrossbow_C", 1, 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItem_WeaponGun_C", 1, 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItem_WeaponShotgun_C", 1, 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItem_WeaponOneShotRifle_C", 1, 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItem_WeaponBow_C", 1, 1, 1, MinQuality, MaxQuality)
			
			Self.AddTemplate(Set, "PrimalItem_WeaponGrenade_C", 2 * AmmoMultiplier, 6 * AmmoMultiplier)
			
			Self.AddTemplate(Set, "PrimalItemAmmo_SimpleBullet_C", 13 * AmmoMultiplier, 52 * AmmoMultiplier)
			Self.AddTemplate(Set, "PrimalItemAmmo_SimpleShotgunBullet_C", 6 * AmmoMultiplier, 24 * AmmoMultiplier)
			Self.AddTemplate(Set, "PrimalItemAmmo_SimpleRifleBullet_C", 8 * AmmoMultiplier, 32 * AmmoMultiplier)
			Self.AddTemplate(Set, "PrimalItemAmmo_ArrowStone_C", 10 * AmmoMultiplier, 40 * AmmoMultiplier)
			Self.AddTemplate(Set, "PrimalItemAmmo_ArrowTranq_C", 10 * AmmoMultiplier, 40 * AmmoMultiplier)
			Self.AddTemplate(Set, "PrimalItemAmmo_ArrowFlame_C", 10 * AmmoMultiplier, 40 * AmmoMultiplier)
			Self.AddTemplate(Set, "PrimalItemAmmo_GrapplingHook_C", 2 * AmmoMultiplier, 8 * AmmoMultiplier)
			
			Self.AddSet(Set)
			Return True
		End Function
	#tag EndMenuHandler

	#tag MenuHandler
		Function AddItemSetSmallSaddles() As Boolean Handles AddItemSetSmallSaddles.Action
			Dim Set As New Ark.ItemSet
			Set.Label = "Small Saddles"
			Set.MinNumItems = 1
			Set.MaxNumItems = 2
			
			Dim MinQuality, MaxQuality As Double
			If Self.mBeacon.IsBonus Then
			MinQuality = Ark.QualityJourneyman
			MaxQuality = Ark.QualityAscendant
			Else
			MinQuality = Ark.QualityPrimitive
			MaxQuality = Ark.QualityApprentice
			End If
			
			Self.AddTemplate(Set, "PrimalItemArmor_ProcoptodonSaddle_C", 1, 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItemArmor_ScorpionSaddle_C", 1, 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItemArmor_RaptorSaddle_C", 1, 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItemArmor_TerrorBirdSaddle_C", 1, 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItemArmor_ArthroSaddle_C", 1, 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItemArmor_SaberSaddle_C", 1, 1, 1, MinQuality, MaxQuality)
			
			If Self.mBeacon.IsScorchedEarth Then
			Self.AddTemplate(Set, "PrimalItemArmor_MothSaddle_C", 1, 1, 1, MinQuality, MaxQuality)
			Else
			Self.AddTemplate(Set, "PrimalItemArmor_PhiomiaSaddle_C", 1, 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItemArmor_StagSaddle_C", 1, 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItemArmor_PachySaddle_C", 1, 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItemArmor_BeaverSaddle_C", 1, 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItemArmor_SpiderSaddle_C", 1, 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItemArmor_ToadSaddle_C", 1, 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItemArmor_DolphinSaddle_C", 1, 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItemArmor_PteroSaddle_C", 1, 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItemArmor_MantaSaddle_C", 1, 1, 1, MinQuality, MaxQuality)
			End If
			
			Self.AddSet(Set)
			Return True
		End Function
	#tag EndMenuHandler

	#tag MenuHandler
		Function AddItemSetStoneHousing() As Boolean Handles AddItemSetStoneHousing.Action
			Dim Set As New Ark.ItemSet
			Set.Label = "Stone Housing"
			Set.MinNumItems = 2
			Set.MaxNumItems = 6
			
			Self.AddTemplate(Set, "PrimalItemStructure_StoneFloor_C", 1, 16)
			Self.AddTemplate(Set, "PrimalItemStructure_StoneWall_C", 1, 32)
			Self.AddTemplate(Set, "PrimalItemStructure_StoneCeiling_C", 1, 16)
			Self.AddTemplate(Set, "PrimalItemStructure_StoneWallWithDoor_C", 1, 2, 0.75)
			Self.AddTemplate(Set, "PrimalItemStructure_StoneDoor_C", 1, 2, 0.75)
			Self.AddTemplate(Set, "PrimalItemStructure_StoneWall_Sloped_Right_C", 2, 4, 0.5)
			Self.AddTemplate(Set, "PrimalItemStructure_StoneWall_Sloped_Left_C", 2, 4, 0.5)
			Self.AddTemplate(Set, "PrimalItemStructure_StoneRoof_C", 1, 16, 0.5)
			Self.AddTemplate(Set, "PrimalItemStructure_StoneWallWithWindow_C", 1, 4, 0.5)
			Self.AddTemplate(Set, "PrimalItemStructure_StoneWindow_C", 1, 4, 0.5)
			
			Self.AddSet(Set)
			Return True
		End Function
	#tag EndMenuHandler

	#tag MenuHandler
		Function AddItemSetStoneTools() As Boolean Handles AddItemSetStoneTools.Action
			Dim Set As New Ark.ItemSet
			Set.Label = "Primitive Tools"
			Set.MinNumItems = 1
			Set.MaxNumItems = 2
			
			Dim MinQuality, MaxQuality As Double
			If Self.mBeacon.IsBonus Then
			MinQuality = Ark.QualityJourneyman
			MaxQuality = Ark.QualityAscendant
			Else
			MinQuality = Ark.QualityPrimitive
			MaxQuality = Ark.QualityApprentice
			End If
			
			Self.AddTemplate(Set, "PrimalItem_WeaponStonePick_C", 1, 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItem_WeaponStoneHatchet_C", 1, 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItem_WeaponTorch_C", 1, 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItem_WeaponFishingRod_C", 1, 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItem_WeaponWhip_C", 1, 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItem_WeaponCompass_C", 1, 1, 1, MinQuality, MaxQuality)
			Self.AddTemplate(Set, "PrimalItem_WeaponSpyglass_C", 1, 1, 1, MinQuality, MaxQuality)
			
			Self.AddSet(Set)
			Return True
		End Function
	#tag EndMenuHandler

	#tag MenuHandler
		Function AddItemSetSupplies() As Boolean Handles AddItemSetSupplies.Action
			Dim Set As New Ark.ItemSet
			Set.Label = "Raw Materials"
			Set.MinNumItems = 1
			Set.MaxNumItems = 4
			Set.ItemsRandomWithoutReplacement = False
			
			If Self.mBeacon.IsBonus Then
			Set.MinNumItems = Set.MinNumItems * 2
			Set.MaxNumItems = Set.MaxNumItems * 2
			End If
			
			Self.AddTemplate(Set, "PrimalItemResource_Wood_C", 100, 100)
			Self.AddTemplate(Set, "PrimalItemResource_Stone_C", 100, 100)
			Self.AddTemplate(Set, "PrimalItemResource_Metal_C", 200, 200)
			Self.AddTemplate(Set, "PrimalItemResource_Hide_C", 200, 200)
			Self.AddTemplate(Set, "PrimalItemResource_Chitin_C", 100, 100)
			Self.AddTemplate(Set, "PrimalItemConsumable_BloodPack_C", 100, 100)
			Self.AddTemplate(Set, "PrimalItemConsumable_Fertilizer_Compost_C", 5, 10)
			Self.AddTemplate(Set, "PrimalItemResource_Flint_C", 100, 100)
			Self.AddTemplate(Set, "PrimalItemResource_MetalIngot_C", 200, 200)
			Self.AddTemplate(Set, "PrimalItemResource_Thatch_C", 100, 100)
			Self.AddTemplate(Set, "PrimalItemResource_Fibers_C", 200, 200)
			Self.AddTemplate(Set, "PrimalItemResource_Charcoal_C", 100, 100)
			Self.AddTemplate(Set, "PrimalItemResource_Crystal_C", 100, 100)
			Self.AddTemplate(Set, "PrimalItemResource_Sparkpowder_C", 100, 100)
			Self.AddTemplate(Set, "PrimalItemResource_Gunpowder_C", 100, 100)
			Self.AddTemplate(Set, "PrimalItemConsumable_Narcotic_C", 100, 100)
			Self.AddTemplate(Set, "PrimalItemConsumable_Stimulant_C", 100, 100)
			Self.AddTemplate(Set, "PrimalItemResource_Obsidian_C", 100, 100)
			Self.AddTemplate(Set, "PrimalItemResource_ChitinPaste_C", 100, 100)
			Self.AddTemplate(Set, "PrimalItemResource_Oil_C", 100, 100)
			Self.AddTemplate(Set, "PrimalItemResource_Silicon_C", 100, 100)
			Self.AddTemplate(Set, "PrimalItemResource_Gasoline_C", 100, 100)
			Self.AddTemplate(Set, "PrimalItemResource_Electronics_C", 100, 100)
			Self.AddTemplate(Set, "PrimalItemResource_Polymer_C", 100, 100)
			Self.AddTemplate(Set, "PrimalItemResource_Keratin_C", 100, 100)
			Self.AddTemplate(Set, "PrimalItemResource_RareFlower_C", 100, 100)
			Self.AddTemplate(Set, "PrimalItemResource_RareMushroom_C", 100, 100)
			Self.AddTemplate(Set, "PrimalItemConsumableMiracleGro_C", 100, 100)
			Self.AddTemplate(Set, "PrimalItemResource_Pelt_C", 100, 100)
			Self.AddTemplate(Set, "PrimalItemResource_Polymer_Organic_C", 10, 10)
			Self.AddTemplate(Set, "PrimalItemResource_AnglerGel_C", 100, 100)
			Self.AddTemplate(Set, "PrimalItemResource_BlackPearl_C", 200, 200)
			Self.AddTemplate(Set, "PrimalItemResource_Horn_C", 20, 20)
			Self.AddTemplate(Set, "PrimalItemResource_LeechBlood_C", 50, 50)
			Self.AddTemplate(Set, "PrimalItemResource_Sap_C", 20, 20)
			Self.AddTemplate(Set, "PrimalItemResource_SubstrateAbsorbent_C", 100, 100)
			
			If Self.mBeacon.IsScorchedEarth Then
			Self.AddTemplate(Set, "PrimalItemResource_Clay_C", 100, 100)
			Self.AddTemplate(Set, "PrimalItemResource_KeratinSpike_C", 20, 20)
			Self.AddTemplate(Set, "PrimalItemResource_PreservingSalt_C", 6, 6)
			Self.AddTemplate(Set, "PrimalItemResource_Sand_C", 100, 100)
			Self.AddTemplate(Set, "PrimalItemResource_Silk_C", 200, 200)
			Self.AddTemplate(Set, "PrimalItemResource_Sulfur_C", 100, 100)
			End If
			
			Self.AddSet(Set)
			Return True
		End Function
	#tag EndMenuHandler

	#tag MenuHandler
		Function AddItemSetThatchHousing() As Boolean Handles AddItemSetThatchHousing.Action
			Dim Set As New Ark.ItemSet
			Set.Label = "Thatch Housing"
			Set.MinNumItems = 2
			Set.MaxNumItems = 4
			
			Self.AddTemplate(Set, "PrimalItemStructure_ThatchFloor_C", 1, 16)
			Self.AddTemplate(Set, "PrimalItemStructure_ThatchWall_C", 1, 32)
			Self.AddTemplate(Set, "PrimalItemStructure_ThatchCeiling_C", 1, 16)
			Self.AddTemplate(Set, "PrimalItemStructure_ThatchWallWithDoor_C", 1, 2, 0.75)
			Self.AddTemplate(Set, "PrimalItemStructure_ThatchDoor_C", 1, 2, 0.75)
			Self.AddTemplate(Set, "PrimalItemStructure_ThatchWall_Sloped_Right_C", 2, 4, 0.5)
			Self.AddTemplate(Set, "PrimalItemStructure_ThatchWall_Sloped_Left_C", 2, 4, 0.5)
			Self.AddTemplate(Set, "PrimalItemStructure_ThatchRoof_C", 1, 16, 0.5)
			
			Self.AddSet(Set)
			Return True
		End Function
	#tag EndMenuHandler

	#tag MenuHandler
		Function AddItemSetWoodHousing() As Boolean Handles AddItemSetWoodHousing.Action
			Dim Set As New Ark.ItemSet
			Set.Label = "Wood Housing"
			Set.MinNumItems = 2
			Set.MaxNumItems = 6
			
			Self.AddTemplate(Set, "PrimalItemStructure_WoodFloor_C", 1, 16)
			Self.AddTemplate(Set, "PrimalItemStructure_WoodWall_C", 1, 32)
			Self.AddTemplate(Set, "PrimalItemStructure_WoodCeiling_C", 1, 16)
			Self.AddTemplate(Set, "PrimalItemStructure_WoodWallWithDoor_C", 1, 2, 0.75)
			Self.AddTemplate(Set, "PrimalItemStructure_WoodDoor_C", 1, 2, 0.75)
			Self.AddTemplate(Set, "PrimalItemStructure_WoodWall_Sloped_Right_C", 2, 4, 0.5)
			Self.AddTemplate(Set, "PrimalItemStructure_WoodWall_Sloped_Left_C", 2, 4, 0.5)
			Self.AddTemplate(Set, "PrimalItemStructure_WoodRoof_C", 1, 16, 0.5)
			Self.AddTemplate(Set, "PrimalItemStructure_WoodRamp_C", 1, 1, 0.25)
			Self.AddTemplate(Set, "PrimalItemStructure_WoodWallWithWindow_C", 1, 4, 0.5)
			Self.AddTemplate(Set, "PrimalItemStructure_WoodWindow_C", 1, 4, 0.5)
			
			Self.AddSet(Set)
			Return True
		End Function
	#tag EndMenuHandler

	#tag MenuHandler
		Function DocumentRemoveItemSet() As Boolean Handles DocumentRemoveItemSet.Action
			Self.RemoveSelectedItemSet()
			Return True
			
		End Function
	#tag EndMenuHandler


	#tag Method, Flags = &h21
		Private Sub AddSet(Set As Ark.ItemSet)
		  Self.mBeacon.Append(Set)
		  SetList.AddRow(Set.Label)
		  SetList.RowTag(SetList.LastIndex) = Set
		  SetList.ListIndex = SetList.LastIndex
		  RaiseEvent Updated
		End Sub
	#tag EndMethod

	#tag Method, Flags = &h21
		Private Sub AddTemplate(Set As Ark.ItemSet, ClassString As String, MinQuantity As Integer, MaxQuantity As Integer, Weight As Double = 1, MinQuality As Double = 1, MaxQuality As Double = 1)
		  Dim Entry As New Ark.SetEntry
		  Entry.Append(New Ark.ItemClass(ClassString.ToText, 1))
		  Entry.MinQuantity = MinQuantity
		  Entry.MaxQuantity = MaxQuantity
		  Entry.MinQuality = MinQuality / Editor.Multipliers.Min
		  Entry.MaxQuality = MaxQuality / Editor.Multipliers.Max
		  Entry.Weight = Weight
		  Entry.ChanceToBeBlueprint = 0.1
		  Set.Append(Entry)
		End Sub
	#tag EndMethod

	#tag Method, Flags = &h0
		Sub EnableMenuItems()
		  AddItemSetEmpty.Enable
		  If Self.mBeacon.IsScorchedEarth Then
		    AddItemSetDesertClothClothing.Enable
		  Else
		    AddItemSetPlatformSaddles.Enable
		  End If
		  AddItemSetAdobeHousing.Enable
		  AddItemSetAdvancedFirearms.Enable
		  AddItemSetAdvancedFurniture.Enable
		  AddItemSetBasicFurniture.Enable
		  AddItemSetChitinArmor.Enable
		  AddItemSetClothClothing.Enable
		  AddItemSetFlakArmor.Enable
		  AddItemSetGhillieSuit.Enable
		  AddItemSetHideClothing.Enable
		  AddItemSetLargeSaddles.Enable
		  AddItemSetMediumSaddles.Enable
		  AddItemSetMetalHousing.Enable
		  AddItemSetMetalTools.Enable
		  AddItemSetRiotArmor.Enable
		  AddItemSetSimpleFirearms.Enable
		  AddItemSetSmallSaddles.Enable
		  AddItemSetStoneHousing.Enable
		  AddItemSetStoneTools.Enable
		  AddItemSetSupplies.Enable
		  AddItemSetThatchHousing.Enable
		  AddItemSetWoodHousing.Enable
		  AddItemSetFurArmor.Enable
		  AddItemSetGardening.Enable
		  If SetList.ListIndex > -1 Then
		    DocumentRemoveItemSet.Enable
		    Editor.EnableMenuItems
		  End If
		End Sub
	#tag EndMethod

	#tag Method, Flags = &h21
		Private Sub RemoveSelectedItemSet()
		  If SetList.ListIndex = -1 Then
		    Return
		  End If
		  
		  Dim Set As Ark.ItemSet = SetList.RowTag(SetList.ListIndex)
		  Dim Idx As Integer = Self.mBeacon.IndexOf(Set)
		  If Idx > -1 Then
		    Self.mBeacon.Remove(Idx)
		    RaiseEvent Updated
		  End If
		  SetList.RemoveRow(SetList.ListIndex)
		End Sub
	#tag EndMethod


	#tag Hook, Flags = &h0
		Event Updated()
	#tag EndHook


	#tag ComputedProperty, Flags = &h0
		#tag Getter
			Get
			  Return Self.mBeacon
			End Get
		#tag EndGetter
		#tag Setter
			Set
			  Self.mBeacon = Value
			  
			  Self.mUpdating = True
			  If Self.mBeacon <> Nil Then
			    LabelField.Text = Self.mBeacon.Label
			    MaxSetsField.Text = Str(Self.mBeacon.MaxItemSets, "-0")
			    MinSetsField.Text = Str(Self.mBeacon.MinItemSets, "-0")
			    DuplicatesCheck.Value = Self.mBeacon.SetsRandomWithoutReplacement
			    SetList.DeleteAllRows
			    For Each Set As Ark.ItemSet In Self.mBeacon
			      SetList.AddRow(Set.Label)
			      SetList.RowTag(SetList.LastIndex) = Set
			    Next
			    Editor.Multipliers = App.DataSource.MultipliersForBeacon(Self.mBeacon)
			  Else
			    LabelField.Text = ""
			    MaxSetsField.Text = ""
			    MinSetsField.Text = ""
			    DuplicatesCheck.Value = True
			    SetList.DeleteAllRows
			  End If
			  Self.mUpdating = False
			End Set
		#tag EndSetter
		Beacon As Ark.Beacon
	#tag EndComputedProperty

	#tag Property, Flags = &h21
		Private mBeacon As Ark.Beacon
	#tag EndProperty

	#tag Property, Flags = &h21
		Private mUpdating As Boolean
	#tag EndProperty


	#tag Constant, Name = kClipboardType, Type = String, Dynamic = False, Default = \"com.thezaz.beacon.itemset", Scope = Private
	#tag EndConstant


#tag EndWindowCode

#tag Events LabelField
	#tag Event
		Sub TextChange()
		  If Self.mUpdating = True Then
		    Return
		  End If
		  
		  If Self.mBeacon <> Nil Then
		    Self.mBeacon.Label = Me.Text.ToText
		    RaiseEvent Updated
		  End If
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events MinSetsField
	#tag Event
		Sub TextChange()
		  If Self.mUpdating = True Then
		    Return
		  End If
		  
		  If Self.mBeacon <> Nil Then
		    Self.mBeacon.MinItemSets = Val(Me.Text)
		    RaiseEvent Updated
		  End If
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events MaxSetsField
	#tag Event
		Sub TextChange()
		  If Self.mUpdating = True Then
		    Return
		  End If
		  
		  If Self.mBeacon <> Nil Then
		    Self.mBeacon.MaxItemSets = Val(Me.Text)
		    RaiseEvent Updated
		  End If
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events DuplicatesCheck
	#tag Event
		Sub Action()
		  If Self.mUpdating = True Then
		    Return
		  End If
		  
		  If Self.mBeacon <> Nil Then
		    Self.mBeacon.SetsRandomWithoutReplacement = Me.Value
		    RaiseEvent Updated
		  End If
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events Separators
	#tag Event
		Sub Paint(index as Integer, g As Graphics, areas() As REALbasic.Rect)
		  #Pragma Unused areas
		  
		  G.ForeColor = &cCCCCCC
		  G.FillRect(0, 0, G.Width, G.Height)
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events SetList
	#tag Event
		Sub Change()
		  RemoveSetButton.Enabled = Me.ListIndex > -1
		  
		  If Me.ListIndex = -1 Then
		    Editor.Enabled = False
		    Editor.Set = Nil
		  Else
		    Editor.Set = Me.RowTag(Me.ListIndex)
		    Editor.Enabled = True
		  End If
		End Sub
	#tag EndEvent
	#tag Event
		Function CanCopy() As Boolean
		  Return Me.ListIndex > -1
		End Function
	#tag EndEvent
	#tag Event
		Function CanPaste(Board As Clipboard) As Boolean
		  Return Board.RawDataAvailable(Self.kClipboardType)
		End Function
	#tag EndEvent
	#tag Event
		Sub PerformClear()
		  Self.RemoveSelectedItemSet()
		End Sub
	#tag EndEvent
	#tag Event
		Sub PerformCopy(Board As Clipboard)
		  Dim Set As Ark.ItemSet = Me.RowTag(Me.ListIndex)
		  Dim Dict As Xojo.Core.Dictionary = BeaconDocument.Export(Set)
		  If Dict <> Nil Then
		    Dim Contents As Text = Xojo.Data.GenerateJSON(Dict)
		    Board.AddRawData(Contents, Self.kClipboardType)
		  End If
		End Sub
	#tag EndEvent
	#tag Event
		Sub PerformPaste(Board As Clipboard)
		  If Not Board.RawDataAvailable(Self.kClipboardType) Then
		    Return
		  End If
		  
		  Dim Contents As String = DefineEncoding(Board.RawData(Self.kClipboardType), Encodings.UTF8)
		  Dim Dict As Xojo.Core.Dictionary
		  Try
		    Dict = Xojo.Data.ParseJSON(Contents.ToText)
		  Catch Err As RuntimeException
		    Beep
		    Return
		  End Try
		  
		  Dim Set As Ark.ItemSet = BeaconDocument.ImportAsItemSet(Dict)
		  Self.AddSet(Set)
		End Sub
	#tag EndEvent
	#tag Event
		Function CanDelete() As Boolean
		  Return Me.ListIndex > -1
		End Function
	#tag EndEvent
#tag EndEvents
#tag Events Editor
	#tag Event
		Sub Updated()
		  If SetList.ListIndex > -1 Then
		    SetList.Cell(SetList.ListIndex, 0) = Ark.ItemSet(SetList.RowTag(SetList.ListIndex)).Label
		  End If
		  RaiseEvent Updated
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events AddSetButton
	#tag Event
		Sub Open()
		  Me.IconNormal = IconAddWithMenuNormal
		  Me.IconPressed = IconAddWithMenuPressed
		  Me.IconDisabled = IconAddWithMenuDisabled
		End Sub
	#tag EndEvent
	#tag Event
		Sub Action()
		  Self.AddSet(New Ark.ItemSet)
		End Sub
	#tag EndEvent
	#tag Event
		Function MouseHold(X As Integer, Y As Integer) As Boolean
		  #Pragma Unused X
		  #Pragma Unused Y
		  
		  Dim Source As MenuItem = DocumentAddItemSet
		  Dim Base As New MenuItem
		  For I As Integer = 0 To Source.Count - 1
		    Dim Item As New MenuItem(Source.Item(I))
		    Base.Append(Item)
		  Next
		  
		  Dim Position As Xojo.Core.Point = Self.GlobalPosition
		  Call Base.PopUp(Position.X + Me.Left, Position.Y + Me.Top + Me.Height)
		  
		  Return True
		End Function
	#tag EndEvent
#tag EndEvents
#tag Events RemoveSetButton
	#tag Event
		Sub Open()
		  Me.IconNormal = IconRemoveNormal
		  Me.IconPressed = IconRemovePressed
		  Me.IconDisabled = IconRemoveDisabled
		End Sub
	#tag EndEvent
	#tag Event
		Sub Action()
		  Self.RemoveSelectedItemSet()
		End Sub
	#tag EndEvent
#tag EndEvents
#tag ViewBehavior
	#tag ViewProperty
		Name="AcceptFocus"
		Visible=true
		Group="Behavior"
		InitialValue="False"
		Type="Boolean"
		EditorType="Boolean"
	#tag EndViewProperty
	#tag ViewProperty
		Name="AcceptTabs"
		Visible=true
		Group="Behavior"
		InitialValue="True"
		Type="Boolean"
		EditorType="Boolean"
	#tag EndViewProperty
	#tag ViewProperty
		Name="AutoDeactivate"
		Visible=true
		Group="Appearance"
		InitialValue="True"
		Type="Boolean"
	#tag EndViewProperty
	#tag ViewProperty
		Name="BackColor"
		Visible=true
		Group="Background"
		InitialValue="&hFFFFFF"
		Type="Color"
	#tag EndViewProperty
	#tag ViewProperty
		Name="Backdrop"
		Visible=true
		Group="Background"
		Type="Picture"
		EditorType="Picture"
	#tag EndViewProperty
	#tag ViewProperty
		Name="Enabled"
		Visible=true
		Group="Appearance"
		InitialValue="True"
		Type="Boolean"
		EditorType="Boolean"
	#tag EndViewProperty
	#tag ViewProperty
		Name="EraseBackground"
		Visible=true
		Group="Behavior"
		InitialValue="True"
		Type="Boolean"
		EditorType="Boolean"
	#tag EndViewProperty
	#tag ViewProperty
		Name="HasBackColor"
		Visible=true
		Group="Background"
		InitialValue="False"
		Type="Boolean"
	#tag EndViewProperty
	#tag ViewProperty
		Name="Height"
		Visible=true
		Group="Size"
		InitialValue="300"
		Type="Integer"
	#tag EndViewProperty
	#tag ViewProperty
		Name="HelpTag"
		Visible=true
		Group="Appearance"
		Type="String"
	#tag EndViewProperty
	#tag ViewProperty
		Name="InitialParent"
		Group="Position"
		Type="String"
	#tag EndViewProperty
	#tag ViewProperty
		Name="Left"
		Visible=true
		Group="Position"
		Type="Integer"
	#tag EndViewProperty
	#tag ViewProperty
		Name="LockBottom"
		Visible=true
		Group="Position"
		Type="Boolean"
	#tag EndViewProperty
	#tag ViewProperty
		Name="LockLeft"
		Visible=true
		Group="Position"
		Type="Boolean"
	#tag EndViewProperty
	#tag ViewProperty
		Name="LockRight"
		Visible=true
		Group="Position"
		Type="Boolean"
	#tag EndViewProperty
	#tag ViewProperty
		Name="LockTop"
		Visible=true
		Group="Position"
		Type="Boolean"
	#tag EndViewProperty
	#tag ViewProperty
		Name="Name"
		Visible=true
		Group="ID"
		Type="String"
		EditorType="String"
	#tag EndViewProperty
	#tag ViewProperty
		Name="Super"
		Visible=true
		Group="ID"
		Type="String"
		EditorType="String"
	#tag EndViewProperty
	#tag ViewProperty
		Name="TabIndex"
		Visible=true
		Group="Position"
		InitialValue="0"
		Type="Integer"
	#tag EndViewProperty
	#tag ViewProperty
		Name="TabPanelIndex"
		Group="Position"
		InitialValue="0"
		Type="Integer"
	#tag EndViewProperty
	#tag ViewProperty
		Name="TabStop"
		Visible=true
		Group="Position"
		InitialValue="True"
		Type="Boolean"
		EditorType="Boolean"
	#tag EndViewProperty
	#tag ViewProperty
		Name="Top"
		Visible=true
		Group="Position"
		Type="Integer"
	#tag EndViewProperty
	#tag ViewProperty
		Name="Transparent"
		Visible=true
		Group="Behavior"
		InitialValue="True"
		Type="Boolean"
		EditorType="Boolean"
	#tag EndViewProperty
	#tag ViewProperty
		Name="UseFocusRing"
		Visible=true
		Group="Appearance"
		InitialValue="False"
		Type="Boolean"
		EditorType="Boolean"
	#tag EndViewProperty
	#tag ViewProperty
		Name="Visible"
		Visible=true
		Group="Appearance"
		InitialValue="True"
		Type="Boolean"
		EditorType="Boolean"
	#tag EndViewProperty
	#tag ViewProperty
		Name="Width"
		Visible=true
		Group="Size"
		InitialValue="300"
		Type="Integer"
	#tag EndViewProperty
#tag EndViewBehavior
